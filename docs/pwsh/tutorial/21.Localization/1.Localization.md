---
layout: default
parent: Localization
title: Localization
nav_order: 1
---

# Localization

Serve localized responses with PowerShell-style string tables resolved per request.

## Full source

File: [`pwsh/tutorial/examples/21.1-Localization.ps1`][21.1-Localization.ps1]

```powershell
{% include examples/pwsh/21.1-Localization.ps1 %}
```

## Step-by-step

1. Root: `Initialize-KrRoot` anchors relative paths for the localization folder.
2. Logging: `New-KrLogger` configures console output.
3. Server: `New-KrServer` creates the host and `Add-KrEndpoint` binds a listener.
4. Localization: `Add-KrLocalizationMiddleware` loads string tables from `Assets/i18n`.
5. Route: `Add-KrMapRoute` returns localized JSON using `Get-KrLocalizedString`.
6. Route: `Add-KrMapRoute` exposes `/cultures` using `Get-KrLocalizationCulture`.
7. Start: `Enable-KrConfiguration` and `Start-KrServer` apply and run.

## Try it

```powershell
# Default culture
curl -i http://127.0.0.1:5000/hello

# Query override (Italian)
curl -i "http://127.0.0.1:5000/hello?lang=it-IT"

# List available cultures
curl -i http://127.0.0.1:5000/cultures
```

## Troubleshooting

- If `/hello` always returns the default culture, verify the request includes `?lang=it-IT` (or an `Accept-Language` header)
and that `Add-KrLocalizationMiddleware` points at the correct `Assets/i18n` folder.
- If `/cultures` is empty, check that culture folders exist (for example `Assets/i18n/en-US/Messages.psd1`)
and that the server started without localization parsing errors.

## References

- [Add-KrLocalizationMiddleware][Add-KrLocalizationMiddleware]
- [Add-KrMapRoute][Add-KrMapRoute]
- [Get-KrLocalizationCulture][Get-KrLocalizationCulture]
- [Get-KrLocalizedString][Get-KrLocalizedString]
- [Write-KrJsonResponse][Write-KrJsonResponse]
- [Initialize-KrRoot][Initialize-KrRoot]
- [Enable-KrConfiguration][Enable-KrConfiguration]
- [Start-KrServer][Start-KrServer]
- [Localization Guide][Localization Guide]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [Tasks](../20.Tasks/index)
Next: [Razor Localization](./2.Razor-Localization)

[21.1-Localization.ps1]: /pwsh/tutorial/examples/21.1-Localization.ps1
[Add-KrLocalizationMiddleware]: /pwsh/cmdlets/Add-KrLocalizationMiddleware
[Add-KrMapRoute]: /pwsh/cmdlets/Add-KrMapRoute
[Get-KrLocalizationCulture]: /pwsh/cmdlets/Get-KrLocalizationCulture
[Get-KrLocalizedString]: /pwsh/cmdlets/Get-KrLocalizedString
[Write-KrJsonResponse]: /pwsh/cmdlets/Write-KrJsonResponse
[Initialize-KrRoot]: /pwsh/cmdlets/Initialize-KrRoot
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
[Localization Guide]: /guides/localization
