---
title: Simple Logging
parent: Logging
nav_order: 1
---

# Simple Logging

Introduce structured logging early: create a named logger with console + rolling file sinks, register it as
the default, then write events from both PowerShell and embedded C# routes.

> Prerequisites: see [Introduction][Introduction]. Ensure you have a `logs` directory (created on demand by the File sink).

## Full source

File: [`docs/_includes/examples/pwsh/5.1-Simple-Logging.ps1`][5.1-Simple-Logging.ps1]

```powershell
{% include examples/pwsh/5.1-Simple-Logging.ps1 %}
```

## Step-by-step

1. Logger builder: `New-KrLogger` starts a builder; we set the minimum level to `Debug`.
2. Sinks: add a rolling hourly file sink (`logs/sample.log`) and the console sink.
3. Register: `Register-KrLogger -SetAsDefault` promotes the logger so framework/internal logs also flow through it.
4. Server & listener: standard setup (server + loopback listener on port 5000).
5. Runtime: add PowerShell runtime so script block routes execute.
6. Initial event: writes an informational log confirming server creation.
7. Routes:
   - `/hello-powershell` writes a debug log then returns text.
   - `/hello-csharp` uses the same logger (closure variable `myLogger`) inside a C# code route.
8. Start: `Start-KrServer` begins processing requests asynchronously.

## Try it

### Start the server

```powershell
pwsh .\docs\_includes\examples\pwsh\5.1-Simple-Logging.ps1
```

### Issue some requests

```powershell
curl http://127.0.0.1:5000/hello-powershell
curl http://127.0.0.1:5000/hello-csharp
```

### View logs

Console output already shows events. File (latest):

```powershell
Get-Content .\logs\sample.log -Tail 20
```

Expected entries include route handling debug messages and the initial informational startup line.

## Customizing

- Change rolling period: `-RollingInterval Day` for daily splits.
- Filter noisier categories later (future chapter) with per-logger overrides.
- Add properties: insert `Add-KrProperty -Name 'App' -Value 'Sample'` before registering.
- Add another sink: e.g., `Add-KrSinkSeq -ServerUrl 'http://localhost:5341'` (if you have Seq running).

## Troubleshooting

| Symptom                               | Cause                              | Fix                                          |
|---------------------------------------|------------------------------------|----------------------------------------------|
| No file created                       | Directory missing or no events yet | Trigger a request; ensure path is writable   |
| Missing debug lines                   | Minimum level too high             | Use `Set-KrMinimumLevel -Value Debug`        |
| Logger variable not found in C# route | Name mismatch                      | Ensure variable name matches (`myLogger`)    |
| Duplicate console lines               | Multiple loggers set as default    | Only set one default or adjust configuration |

## Cmdlet references

- [New-KrLogger][New-KrLogger]
- [Set-KrMinimumLevel][Set-KrMinimumLevel]
- [Add-KrSinkFile][Add-KrSinkFile]
- [Add-KrSinkConsole][Add-KrSinkConsole]
- [Register-KrLogger][Register-KrLogger]
- [Write-KrLog][Write-KrLog]
- [Add-KrMapRoute][Add-KrMapRoute]
- [Start-KrServer][Start-KrServer]

---

### Next

{: .fs-4 .fw-500}

Previous: [Shared Variables](../4.variable/index)
Next: Multiple Loggers & Levels (coming soon)
Guide: [Logging (Concepts)](/docs/guides/logging)

[5.1-Simple-Logging.ps1]: /docs/_includes/examples/pwsh/5.1-Simple-Logging.ps1
[New-KrLogger]: /docs/pwsh/cmdlets/New-KrLogger
[Set-KrMinimumLevel]: /docs/pwsh/cmdlets/Set-KrMinimumLevel
[Add-KrSinkFile]: /docs/pwsh/cmdlets/Add-KrSinkFile
[Add-KrSinkConsole]: /docs/pwsh/cmdlets/Add-KrSinkConsole
[Register-KrLogger]: /docs/pwsh/cmdlets/Register-KrLogger
[Write-KrLog]: /docs/pwsh/cmdlets/Write-KrLog
[Add-KrMapRoute]: /docs/pwsh/cmdlets/Add-KrMapRoute
[Start-KrServer]: /docs/pwsh/cmdlets/Start-KrServer
[Introduction]: ../1.introduction/index#prerequisites
