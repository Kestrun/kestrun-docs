---
title: Sinks (HTTP/EventLog/Syslog)
parent: Logging
nav_order: 5
---

# Sinks (HTTP/EventLog/Syslog)

Push logs to external systems. This chapter shows optional sinks you can enable
as needed. The sample runs with console + file, and enables Local syslog by
default (best on Linux/macOS). Comment out the Local syslog line if it doesn't
apply to your environment.

> See the [Logging guide](/guides/logging) for a broader list and options.

## Full source

File: [`pwsh/tutorial/examples/5.5-Sinks-Advanced.ps1`][5.5-Sinks-Advanced.ps1]

```powershell
{% include examples/pwsh/5.5-Sinks-Advanced.ps1 %}
```

## Step-by-step

1. Build a base logger with Console + File.
2. Optionally enable (the sample enables Local syslog by default):
   - HTTP sink: set a reachable endpoint.
   - EventLog sink: requires admin rights and source/log configuration.
   - Syslog sink: UDP/TCP/Local depending on your environment; Local is
       primarily for Linux/macOS.
3. Register as `advanced`; standard server + listener + PS runtime.
4. Apply config: `Enable-KrConfiguration` to commit the listener/runtime.
5. Route `/log` emits an Information event.

## Try it

Save the sample locally so the log file is easy to find. Copy the contents of
[`pwsh/tutorial/examples/5.5-Sinks-Advanced.ps1`][5.5-Sinks-Advanced.ps1] into a new file in an
empty working folder (for example, `advanced-sinks.ps1`), then run:

```powershell
# From your working folder
pwsh .\advanced-sinks.ps1
curl http://127.0.0.1:5000/log
Get-Content .\logs\advanced-sinks.log -Tail 20
```

To test advanced sinks:

- HTTP: start a local receiver (e.g., a simple web API) and set `-RequestUri`.
- EventLog: run elevated and ensure the source/log exists or pass `-ManageEventSource` if supported.
- Syslog (UDP/TCP): run a local syslog server and point the hostname/port accordingly.
- Syslog (Local): on Linux/macOS, Local syslog writes to the system log; on
   Windows, comment out the Local syslog line or use UDP/TCP instead.

## Customizing

- Batch/format HTTP payloads using sink options.
- Change Syslog facility/format; change EventLog source/log.
- Enrich with app/environment properties for routing in external systems.

## Troubleshooting

| Symptom                       | Cause                           | Fix                                            |
|-------------------------------|---------------------------------|------------------------------------------------|
| HTTP requests fail            | Unreachable endpoint            | Verify URL; firewall; try a local receiver     |
| No EventLog entries           | Permissions/source issues       | Run elevated; ensure source/log exist          |
| Syslog not receiving          | Wrong host/port/protocol        | Match server settings; try UDP 514 or TCP 1468 |
| Local syslog not writing      | Unsupported on OS or service    | Use Linux/macOS or switch to UDP/TCP           |
| Cannot delete/rename log file | Logger still open / file handle | Run `Close-KrLogger`; let the process exit     |

## Cmdlet references

- [New-KrLogger][New-KrLogger]
- [Set-KrLoggerMinimumLevel][Set-KrLoggerMinimumLevel]
- [Add-KrSinkFile][Add-KrSinkFile]
- [Add-KrSinkConsole][Add-KrSinkConsole]
- [Add-KrSinkHttp][Add-KrSinkHttp]
- [Add-KrSinkEventLog][Add-KrSinkEventLog]
- [Add-KrSinkSyslogUdp][Add-KrSinkSyslogUdp]
- [Add-KrSinkSyslogTcp][Add-KrSinkSyslogTcp]
- [Add-KrSinkSyslogLocal][Add-KrSinkSyslogLocal]
- [Register-KrLogger][Register-KrLogger]
- [Write-KrLog][Write-KrLog]
- [Close-KrLogger][Close-KrLogger]
- [New-KrServer][New-KrServer]
- [Add-KrMapRoute][Add-KrMapRoute]
- [Start-KrServer][Start-KrServer]

---

### Next

{: .fs-4 .fw-500}

Previous: [Sinks (Console/File/JSON)](./4.Sinks)
Next: [Hot Reload (Update Logger)](./6.Hot-Reload)
Guide: [Logging (Concepts)](/guides/logging)

[5.5-Sinks-Advanced.ps1]: pwsh/tutorial/examples/5.5-Sinks-Advanced.ps1
[New-KrLogger]: /pwsh/cmdlets/New-KrLogger
[Set-KrLoggerMinimumLevel]: /pwsh/cmdlets/Set-KrLoggerMinimumLevel
[Add-KrSinkFile]: /pwsh/cmdlets/Add-KrSinkFile
[Add-KrSinkConsole]: /pwsh/cmdlets/Add-KrSinkConsole
[Add-KrSinkHttp]: /pwsh/cmdlets/Add-KrSinkHttp
[Add-KrSinkEventLog]: /pwsh/cmdlets/Add-KrSinkEventLog
[Add-KrSinkSyslogUdp]: /pwsh/cmdlets/Add-KrSinkSyslogUdp
[Add-KrSinkSyslogTcp]: /pwsh/cmdlets/Add-KrSinkSyslogTcp
[Add-KrSinkSyslogLocal]: /pwsh/cmdlets/Add-KrSinkSyslogLocal
[Register-KrLogger]: /pwsh/cmdlets/Register-KrLogger
[Write-KrLog]: /pwsh/cmdlets/Write-KrLog
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrMapRoute]: /pwsh/cmdlets/Add-KrMapRoute
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
[Close-KrLogger]: /pwsh/cmdlets/Close-KrLogger
