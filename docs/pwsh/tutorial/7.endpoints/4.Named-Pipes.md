---
title: Named Pipes (Windows)
parent: Endpoints
nav_order: 4
---

# Named Pipes (Windows)

Bind Kestrun to a Windows named pipe for local IPC instead of a TCP port.

> Prerequisites: see [Introduction][Introduction].

## Full source

File: [`pwsh/tutorial/examples/7.4-Named-Pipes.ps1`][7.4-Named-Pipes.ps1]

```powershell
{% include examples/pwsh/7.4-Named-Pipes.ps1 %}
```

## Step-by-step

1. Guard: exit if not Windows.
2. Create server.
3. Add named pipe listener with `Add-KrNamedPipeListener`.
4. Add runtime & enable configuration.
5. Map `/pipe` route.
6. Start server.

## Try it

In a second PowerShell session (after the server is running):

```powershell
Invoke-KrWebRequest -NamedPipeName 'kestrun.demo.pipe' -Method GET -Path '/pipe'
```

Expected (truncated example):

```text
StatusCode : 200
Content    : Hello over named pipe
```

If you get 404, confirm the route pattern is `/pipe` and the pipe name matches.

## Why use pipes?

| Benefit     | Detail                                  |
| ----------- | --------------------------------------- |
| Local only  | Not exposed on network interfaces       |
| Avoid ports | No port conflicts / firewall tweaks     |
| IPC perf    | Efficient for tool -> service scenarios |

## Cmdlet references

- [Add-KrNamedPipeListener][Add-KrNamedPipeListener]
- [New-KrServer][New-KrServer]
- [Add-KrPowerShellRuntime][Add-KrPowerShellRuntime]
- [Enable-KrConfiguration][Enable-KrConfiguration]
- [Add-KrMapRoute][Add-KrMapRoute]
- [Write-KrTextResponse][Write-KrTextResponse]
- [Start-KrServer][Start-KrServer]

## Troubleshooting

| Symptom                  | Cause                                 | Fix                                            |
| ------------------------ | ------------------------------------- | ---------------------------------------------- |
| Cannot connect           | Client not using pipe                 | Ensure correct pipe name in client             |
| Script exits immediately | Not Windows                           | Run only on Windows                            |
| 404 Not Found            | Wrong path                            | Use `/pipe` exactly                            |
| Access denied            | Pipe name already in use / permission | Stop previous instance or choose a unique name |

See also: [Routes](../2.routes/index) Â· [Logging](../5.logging/index)

---

### Next

Continue to [Unix Sockets](./5.Unix-Sockets).

[7.4-Named-Pipes.ps1]: /pwsh/tutorial/examples/7.4-Named-Pipes.ps1
[Add-KrNamedPipeListener]: /pwsh/cmdlets/Add-KrNamedPipeListener
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrPowerShellRuntime]: /pwsh/cmdlets/Add-KrPowerShellRuntime
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Add-KrMapRoute]: /pwsh/cmdlets/Add-KrMapRoute
[Write-KrTextResponse]: /pwsh/cmdlets/Write-KrTextResponse
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
[Introduction]: ../1.introduction/index#prerequisites
