---
title: Unix Sockets
parent: Endpoints
nav_order: 5
---

# Unix Sockets

Bind to a Unix domain socket instead of TCP for local reverse proxy performance.

> Prerequisites: see [Introduction][Introduction].

## Full source

File: [`pwsh/tutorial/examples/7.5-Unix-Sockets.ps1`][7.5-Unix-Sockets.ps1]

```powershell
{% include examples/pwsh/7.5-Unix-Sockets.ps1 %}
```

## Step-by-step

1. Check OS (warn/skip on Windows).
2. Create server.
3. Add Unix socket listener with `Add-KrListenUnixSocket`.
4. Add runtime & enable configuration.
5. Map `/ux` route.
6. Start server.

## Try it

In another shell (after the server is running):

```powershell
Invoke-WebRequest -UnixSocket $(Join-Path -Path $env:TEMP -ChildPath 'kestrun-demo.sock') -Method GET -Uri 'http://localhost/ux'
```

Expected (truncated):

```text
StatusCode : 200
Content    : Hello via unix socket
```

If you get 404 verify the route is `/ux` and the socket path matches the one in the script.

## Reverse proxy (nginx) snippet

```nginx
location / {
    proxy_pass http://unix:/tmp/kestrun-demo.sock;
}
```

## Cmdlet references

- [Add-KrListenUnixSocket][Add-KrListenUnixSocket]
- [New-KrServer][New-KrServer]
- [Add-KrPowerShellRuntime][Add-KrPowerShellRuntime]
- [Enable-KrConfiguration][Enable-KrConfiguration]
- [Add-KrMapRoute][Add-KrMapRoute]
- [Write-KrTextResponse][Write-KrTextResponse]
- [Start-KrServer][Start-KrServer]

## Troubleshooting

| Symptom             | Cause               | Fix                                 |
| ------------------- | ------------------- | ----------------------------------- |
| Socket file remains | Crash / abrupt stop | Manually remove stale file          |
| Proxy 502           | Wrong socket path   | Match proxy config to `-SocketPath` |

See also: [Routes](../2.routes/index) Â· [Logging](../5.logging/index)

---

### Next

Continue to [Lifecycle / Start-Stop](../14.lifecycle/1.Start-Stop).

[7.5-Unix-Sockets.ps1]: /pwsh/tutorial/examples/7.5-Unix-Sockets.ps1
[Add-KrListenUnixSocket]: /pwsh/cmdlets/Add-KrListenUnixSocket
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrPowerShellRuntime]: /pwsh/cmdlets/Add-KrPowerShellRuntime
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Add-KrMapRoute]: /pwsh/cmdlets/Add-KrMapRoute
[Write-KrTextResponse]: /pwsh/cmdlets/Write-KrTextResponse
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
[Introduction]: ../1.introduction/index#prerequisites
