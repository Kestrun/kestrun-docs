---
title: URI Endpoint
parent: Endpoints
nav_order: 7
---

# URI Endpoint Listener

Demonstrates using a pre-built `System.Uri` with `Add-KrEndpoint -Uri` instead of separately specifying
`-Port`, `-IPAddress`, and related parameters. This can simplify scenarios where the endpoint is already
expressed as a string or comes from configuration.

## Full source

File: [`pwsh/tutorial/examples/7.7-Uri-Endpoint.ps1`][7.7-Uri-Endpoint.ps1]

```powershell
{% include examples/pwsh/7.7-Uri-Endpoint.ps1 %}
```

## When to use `-Uri`

- You receive endpoints as strings (e.g. JSON/YAML config) and want a single parse step.
- You need IPv6 loopback (`http://[::1]:5000`) or custom host binding expressed directly.
- You want to reduce positional parameter ambiguity in scripts.

`Add-KrEndpoint -Uri` will infer scheme (HTTP/HTTPS) and port from the provided `System.Uri` instance.
For HTTPS you still need either a certificate (`-CertPath`, `-Certificate`) or `-SelfSignedCert`.

## Step-by-step

1. Configure optional console logger.
2. Create the server.
3. Add a listener with `-Uri ([uri]::new('http://localhost:5000'))` and override address family (example shows `InterNetworkV6`).
4. Add the PowerShell runtime.
5. Enable configuration to lock in server + listener.
6. Map a `/hello` route that writes a text response.
7. Log a startup message.
8. Start the server.

## Try it

```powershell
Invoke-WebRequest -Uri 'http://localhost:5000/hello'
```

Should return body:

```text
Hello from basic server
```

Or with `curl`:

```powershell
curl http://localhost:5000/hello
```

## IPv6 example

```powershell
Add-KrEndpoint -Uri ([uri]::new('http://[::1]:5005'))
```

## Cmdlet references

- [Add-KrEndpoint][Add-KrEndpoint]
- [New-KrServer][New-KrServer]
- [Add-KrPowerShellRuntime][Add-KrPowerShellRuntime]
- [Enable-KrConfiguration][Enable-KrConfiguration]
- [Add-KrMapRoute][Add-KrMapRoute]
- [Start-KrServer][Start-KrServer]
- [Write-KrLog][Write-KrLog]

## Troubleshooting

| Symptom              | Cause                          | Fix                                                            |
| -------------------- | ------------------------------ | -------------------------------------------------------------- |
| 404 on /hello        | Route added too early           | Ensure runtime then `Enable-KrConfiguration` before mapping    |
| Port already in use  | Another process bound           | Change port in the URI or stop conflicting process             |
| IPv6 not reachable   | OS/network disabled IPv6        | Use IPv4 (`127.0.0.1`) or enable IPv6 stack                    |
| HTTPS fails (no cert)| No certificate supplied         | Add `-SelfSignedCert` or specify a certificate parameters       |

See also: [Basic Server](./1.Basic-Server) · [Multiple Listeners](./2.Multiple-Listeners) · [HTTPS](./3.Https)

---

### Next

Continue to [Mixed HTTP Protocols](./6.Mixed-HttpProtocols) if you have not explored protocol
negotiation, or move on to [Server Configuration](../13.server-configuration/index) for advanced
tuning.

[7.7-Uri-Endpoint.ps1]: /pwsh/tutorial/examples/pwsh/7.7-Uri-Endpoint.ps1
[Add-KrEndpoint]: /pwsh/cmdlets/Add-KrEndpoint
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrPowerShellRuntime]: /pwsh/cmdlets/Add-KrPowerShellRuntime
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Add-KrMapRoute]: /pwsh/cmdlets/Add-KrMapRoute
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
[Write-KrLog]: /pwsh/cmdlets/Write-KrLog
