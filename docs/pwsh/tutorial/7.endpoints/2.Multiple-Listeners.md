---
title: Multiple Listeners
parent: Endpoints
nav_order: 2
---

# Multiple Listeners

Serve the same routes on more than one port / interface.

> Prerequisites: see [Introduction][Introduction].

## Full source

File: [`pwsh/tutorial/examples/7.2-Multiple-Listeners.ps1`][7.2-Multiple-Listeners.ps1]

```powershell
{% include examples/pwsh/7.2-Multiple-Listeners.ps1 %}
```

## Step-by-step

1. Create server.
2. Add first listener: 5000 loopback.
3. Add second listener: 6000 loopback.
4. Add PowerShell runtime and commit config.
5. Register one `/ping` route (shared by all listeners).
6. Start server.

## Try it

```powershell
curl http://127.0.0.1:5000/ping
curl http://127.0.0.1:6000/ping

Invoke-WebRequest -Uri http://127.0.0.1:5000/ping | Select-Object -ExpandProperty Content
Invoke-WebRequest -Uri http://127.0.0.1:6000/ping | Select-Object -ExpandProperty Content
```

Both return `pong`.

## References

- [New-KrServer][New-KrServer]
- [Add-KrEndpoint][Add-KrEndpoint]
- [Enable-KrConfiguration][Enable-KrConfiguration]
- [Add-KrMapRoute][Add-KrMapRoute]
- [Start-KrServer][Start-KrServer]
- [Write-KrTextResponse][Write-KrTextResponse]

## Troubleshooting

| Symptom | Cause | Fix |
|---------|-------|-----|
| One port works, other fails | Port already bound | Choose free port |
| Route works on first only | Config enabled before second listener | Add all listeners before `Enable-KrConfiguration` |

See also: [Routes](../2.routes/index) Â· [Logging](../5.logging/index)

---

### Previous / Next

Go back to [Basic Server][Previous] or continue to [HTTPS & Certificates][Next].

[7.2-Multiple-Listeners.ps1]: /pwsh/tutorial/examples/7.2-Multiple-Listeners.ps1
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrEndpoint]: /pwsh/cmdlets/Add-KrEndpoint
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Add-KrMapRoute]: /pwsh/cmdlets/Add-KrMapRoute
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
[Write-KrTextResponse]: /pwsh/cmdlets/Write-KrTextResponse
[Previous]: ./1.Basic-Server
[Next]: ./3.Https
[Introduction]: ../1.introduction/index#prerequisites
