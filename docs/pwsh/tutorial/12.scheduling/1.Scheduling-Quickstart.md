---
title: Scheduling Quickstart
parent: Scheduler
nav_order: 1
---

# Scheduling Quickstart

Enable the scheduler, register a couple of jobs, and expose diagnostic routes.

## Full source

File: [`pwsh/tutorial/examples/12.1-Scheduling-Quickstart.ps1`][12.1-Scheduling-Quickstart.ps1]

```powershell
{% include examples/pwsh/12.1-Scheduling-Quickstart.ps1 %}
```

## Step-by-step

1. Logging — console sink for visibility
2. Server — create host and listener (loopback:5000)
3. Runtime — add PowerShell runtime and scheduler (4 runspaces)
4. Shared state — global `Visits` counter injected into runspaces
5. Enable configuration — finalize the pipeline
6. Jobs — two heartbeats (PS every 10s; C# every 15s)
7. Routes — `/visit` increments counter; `/schedule/report` returns a JSON report
8. Start — run the server; observe log heartbeats and query endpoints

## Try it

```powershell
Invoke-RestMethod http://127.0.0.1:5000/visit -SkipCertificateCheck
Invoke-RestMethod http://127.0.0.1:5000/schedule/report -SkipCertificateCheck | ConvertTo-Json -Depth 4
```

You should see job entries similar to:

```json
{
  "generatedAt": "2025-10-03T12:00:00Z",
  "jobs": [
    { "name": "heartbeat-ps", "lastRunAt": "…", "nextRunAt": "…", "isSuspended": false },
    { "name": "heartbeat-cs", "lastRunAt": "…", "nextRunAt": "…", "isSuspended": false }
  ]
}
```

## Troubleshooting

| Symptom | Cause | Fix |
|---------|-------|-----|
| No jobs appear | Scheduler not added or config not enabled | Call `Add-KrScheduling` and `Enable-KrConfiguration` before `Start-KrServer` |
| Heartbeats not running | Interval too long or suspended | Check `Get-KrScheduleSnapshot` and adjust intervals/suspension |
| Report missing fields | Depth too shallow | Increase `ConvertTo-Json -Depth` when inspecting |
| Route 404s | Pattern mismatch | Verify route paths `/visit` and `/schedule/report` |

## References

- [Add-KrScheduling][Add-KrScheduling]
- [Register-KrSchedule][Register-KrSchedule]
- [Get-KrScheduleReport][Get-KrScheduleReport]
- [Get-KrScheduleSnapshot][Get-KrScheduleSnapshot]
- [Suspend-KrSchedule][Suspend-KrSchedule]
- [Resume-KrSchedule][Resume-KrSchedule]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [_None_](.)
Next: [Scheduling with CRON][Next]

[12.1-Scheduling-Quickstart.ps1]: /pwsh/tutorial/examples/12.1-Scheduling-Quickstart.ps1
[Add-KrScheduling]: /pwsh/cmdlets/Add-KrScheduling
[Register-KrSchedule]: /pwsh/cmdlets/Register-KrSchedule
[Get-KrScheduleReport]: /pwsh/cmdlets/Get-KrScheduleReport
[Get-KrScheduleSnapshot]: /pwsh/cmdlets/Get-KrScheduleSnapshot
[Suspend-KrSchedule]: /pwsh/cmdlets/Suspend-KrSchedule
[Resume-KrSchedule]: /pwsh/cmdlets/Resume-KrSchedule
[Next]: ./2.Scheduling-Cron
