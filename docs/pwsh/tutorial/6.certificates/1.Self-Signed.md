---
title: Create a Self‑Signed Certificate
parent: Certificates
nav_order: 1
---

# Create a Self‑Signed Certificate

Generate a development certificate for localhost and bind it to an HTTPS listener.

> Prerequisites: see [Introduction][Introduction].

## Full source

```powershell
{% include examples/pwsh/6.1-Cert-SelfSigned.ps1 %}
```

## Step-by-step

1. Initialize root: `Initialize-KrRoot -Path $PSScriptRoot` so relative paths resolve predictably.
2. Logging: create and register a default console logger at Debug (helps trace setup and requests).
3. Create a development certificate with `New-KrSelfSignedCertificate`:
    - Dns: `-DnsNames 'localhost'[, '127.0.0.1']` (or your machine DNS).
    - Key: `-KeyType Rsa|Ecdsa` and `-KeyLength` (e.g., 2048 for RSA).
    - Subject (optional): `-Country`, `-Org`, `-CommonName`.
    - Other (optional): `-Exportable`, `-ValidDays 30` for dev convenience.
4. Inspect EKU (optional): `Get-KrCertificatePurpose -Certificate $cert` to verify usages like ServerAuth.
5. Create server and PowerShell runtime: `New-KrServer`; then `Add-KrPowerShellRuntime`.
6. Bind HTTPS listener: `Add-KrListener -Port 5001 -IPAddress Loopback -X509Certificate $cert`.
    - Optionally keep HTTP on 5000 for plaintext testing.
    - You can restrict protocols, e.g., `-Protocols Http1`.
7. Apply config: `Enable-KrConfiguration`.
8. Map a minimal route (e.g., GET `/hello`) returning JSON so you can verify TLS termination.
9. Start the server: `Start-KrServer`.
10. Client notes:
    - For self‑signed certs, use `curl -k` or `Invoke-WebRequest -SkipCertificateCheck` during development.
    - Prefer trusting the certificate locally for clean validation when possible.

## Try it

Save the sample locally so it’s easy to run. Copy the contents of
[`pwsh/tutorial/examples/6.1-Cert-SelfSigned.ps1`](pwsh/tutorial/examples/6.1-Cert-SelfSigned.ps1)
into a new file in an empty working folder (for example, `cert-https.ps1`), then run:

```powershell
# From your working folder
pwsh .\cert-https.ps1
curl -k https://127.0.0.1:5001/hello
Invoke-WebRequest -SkipCertificateCheck -Uri 'https://127.0.0.1:5001/hello' | Select-Object -ExpandProperty Content
```

Note: -k/SkipCertificateCheck is used because this is a self‑signed development cert.

## Cmdlet references

-   [New-KrSelfSignedCertificate][New-KrSelfSignedCertificate]
-   [Get-KrCertificatePurpose][Get-KrCertificatePurpose]
-   [Add-KrListener][Add-KrListener]
-   [New-KrServer][New-KrServer]
-   [Add-KrPowerShellRuntime][Add-KrPowerShellRuntime]
-   [Enable-KrConfiguration][Enable-KrConfiguration]
-   [Add-KrMapRoute][Add-KrMapRoute]
-   [Start-KrServer][Start-KrServer]

---

### Next

{: .fs-4 .fw-500}

Continue to [Generate a CSR][Next] or visit the [Certificates guide](/topics/certificates).

[New-KrSelfSignedCertificate]: /pwsh/cmdlets/New-KrSelfSignedCertificate
[Get-KrCertificatePurpose]: /pwsh/cmdlets/Get-KrCertificatePurpose
[Add-KrListener]: /pwsh/cmdlets/Add-KrListener
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrPowerShellRuntime]: /pwsh/cmdlets/Add-KrPowerShellRuntime
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Add-KrMapRoute]: /pwsh/cmdlets/Add-KrMapRoute
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
[Next]: ./2.CSR
[Introduction]: ../1.introduction/index#prerequisites
