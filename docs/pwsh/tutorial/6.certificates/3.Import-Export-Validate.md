---
title: Import, Export, Validate & EKU
parent: Certificates
nav_order: 3
---

# Import, Export, Validate & EKU

Expose API endpoints to import a certificate and export it in different formats, with simple validation and EKU reporting.

> Prerequisites: see [Introduction][Introduction].

## Full source

```powershell
{% include examples/pwsh/6.3-Cert-Import-Export.ps1 %}
```

## Step-by-step

1. Initialize: `Initialize-KrRoot -Path $PSScriptRoot`.
2. Logging: a console logger named `myLogger` is registered at Debug to trace operations.
3. Server and listener:
        - `New-KrServer -Name 'Cert Ops API'`
        - `Add-KrListener -Port 5000 -IPAddress Loopback`
        - `Add-KrPowerShellRuntime` and `Enable-KrConfiguration`
4. Map routes:
         - POST `/certs/import` reads JSON `{ filePath, password? }` and returns
             `subject`, `notAfter`, `valid` (from `Test-KrCertificate`), and `purposes` (from `Get-KrCertificatePurpose`).
             Format is auto-detected by `Import-KrCertificate`.
         - POST `/certs/export` reads JSON `{ outPath, outFormat, includePrivateKey?, password? }`,
             creates a temporary self‑signed certificate, and exports it to the requested format/path;
             returns `{ exported, path, format }`.
5. Supported formats:
        - Import: auto‑detects `Pfx`, `Pem`, or `Der` based on file content/extension.
        - Export: `outFormat` accepts `Pfx` or `Pem` (PEM may split key/cert; PFX can bundle with password).
6. Errors:
        - Import: returns HTTP 200 with `{ error: '...' }` on failure (demo behavior in sample).
        - Export: returns HTTP 400 with `{ error: '...' }` on failure.
7. Start server: `Start-KrServer`.

## Try it

Save the sample locally so it’s easy to run. Copy the contents of
[`pwsh/tutorial/examples/6.3-Cert-Import-Export.ps1`](pwsh/tutorial/examples/6.3-Cert-Import-Export.ps1)
into a new file in an empty working folder (for example, `cert-ops.ps1`), then run:

```powershell
# From your working folder
pwsh .\cert-ops.ps1

# Export a temporary self-signed cert to PFX (include private key)
curl -X POST http://127.0.0.1:5000/certs/export -H "Content-Type: application/json" `
         -d '{"outPath":"./exported","outFormat":"Pfx","includePrivateKey":true,"password":"p@ss"}'

# Import a PFX
curl -X POST http://127.0.0.1:5000/certs/import -H "Content-Type: application/json" `
        -d '{"filePath":"./exported.pfx","password":"p@ss"}'
```

PowerShell alternatives:

```powershell
# Export a temporary self-signed cert to PFX (include private key)
Invoke-RestMethod -Method Post -Uri 'http://127.0.0.1:5000/certs/export' -ContentType 'application/json' -Body (@{
    outPath           = './exported'
    outFormat         = 'Pfx'
    includePrivateKey = $true
    password          = 'p@ss'
} | ConvertTo-Json)

# Import a PFX
Invoke-RestMethod -Method Post -Uri 'http://127.0.0.1:5000/certs/import' -ContentType 'application/json' -Body (@{
    filePath = './exported.pfx'
    password = 'p@ss'
} | ConvertTo-Json)
```

## Cmdlet references

- [Import-KrCertificate][Import-KrCertificate]
- [Export-KrCertificate][Export-KrCertificate]
- [Test-KrCertificate][Test-KrCertificate]
- [Get-KrCertificatePurpose][Get-KrCertificatePurpose]
- [New-KrSelfSignedCertificate][New-KrSelfSignedCertificate]

---

### Next

{: .fs-4 .fw-500}

Return to [Certificates][Next] or visit the [Certificates guide](/topics/certificates).

[Import-KrCertificate]: /pwsh/cmdlets/Import-KrCertificate
[Export-KrCertificate]: /pwsh/cmdlets/Export-KrCertificate
[Test-KrCertificate]: /pwsh/cmdlets/Test-KrCertificate
[Get-KrCertificatePurpose]: /pwsh/cmdlets/Get-KrCertificatePurpose
[New-KrSelfSignedCertificate]: /pwsh/cmdlets/New-KrSelfSignedCertificate
[Next]: ./index
[Introduction]: ../1.introduction/index#prerequisites
