---
title: Response Components
parent: OpenApi
nav_order: 5
---

# Response Components

Create reusable response components for consistent response structures across multiple endpoints.

## Full source

File: [`pwsh/tutorial/examples/10.5-OpenAPI-Component-Response.ps1`][10.5-OpenAPI-Component-Response.ps1]

```powershell
{% include examples/pwsh/10.5-OpenAPI-Component-Response.ps1 %}
```

## Step-by-step

1. **Logging**: Register console logger as default.
2. **Server**: Create server named 'OpenAPI Response Component' and add endpoint.
3. **OpenAPI info**: Add title and description.
4. **Schema components**: Define `ErrorResponse`, `Article`, and `SuccessResponse` schema classes.
5. **Response components**: Define reusable response component *variables* decorated with `[OpenApiResponseComponent]`.
6. **GET endpoint**: Reference response components using `[OpenApiResponseRefAttribute]`.
7. **POST endpoint**: Create article with success/error response references.
8. **DELETE endpoint**: Delete article with success/error response references.
9. **Build and test**: Generate and validate OpenAPI document.

## Try it

```powershell
# Get article (success response)
curl -i http://127.0.0.1:5000/articles/1

# Get article with invalid ID (error response)
curl -i http://127.0.0.1:5000/articles/-1

# Create article (success response)
curl -X POST http://127.0.0.1:5000/articles `
  -H "Content-Type: application/json" `
  -d '{
    "title": "My Article",
    "content": "Article content here"
  }'

# Create with missing fields (error response)
curl -X POST http://127.0.0.1:5000/articles `
  -H "Content-Type: application/json" `
  -d '{"title": "Missing content"}'

# Delete article (success response)
curl -X DELETE http://127.0.0.1:5000/articles/1
```

PowerShell create example:

```powershell
$body = @{
    title   = 'My Article'
    content = 'Article content here'
} | ConvertTo-Json

Invoke-WebRequest -Uri http://127.0.0.1:5000/articles `
    -Method Post `
    -Headers @{ 'Content-Type' = 'application/json' } `
    -Body $body | Select-Object StatusCode, Content
```

## Response Component Attributes

**Basic Pattern:**

```powershell
[OpenApiResponseComponent(
    Description = 'Article retrieved successfully',
    ContentType = ('application/json', 'application/xml'),
    Inline = $true
)]
[OpenApiResponseHeaderRef(Key = 'X-Correlation-Id', ReferenceId = 'X-Correlation-Id')]
[OpenApiResponseLinkRef(Key = 'delete', ReferenceId = 'DeleteArticleLink')]
[Article]$ArticleResponsesOK = NoDefault

[OpenApiResponseComponent(Description = 'Article not found', ContentType = ('application/json', 'application/xml'))]
[OpenApiResponseHeaderRef(Key = 'X-Correlation-Id', ReferenceId = 'X-Correlation-Id')]
[OpenApiResponseExampleRef(Key = 'default', ReferenceId = 'NotFoundErrorExample', ContentType = ('application/json', 'application/xml'))]
[ErrorResponse]$ArticleResponsesNotFound = NoDefault
```

**Attribute Properties:**

- **`[OpenApiResponseComponent(...)]`**: Declares a reusable response component on a *variable*.
  - **Description**: Human-readable response description.
  - **ContentType**: MIME types the response supports (e.g., `('application/json', 'application/xml')`).
  - **Inline**: If `$true`, includes response inline; otherwise references the component.
- **`[OpenApiResponseHeaderRef(...)]`**, **`[OpenApiResponseLinkRef(...)]`**, **`[OpenApiResponseExampleRef(...)]`**:
Attach headers/links/examples *to the response component*.

**Schema Definition:**

- **Type on variable**: `[ErrorResponse]$NotFound = NoDefault` â€” schema inferred from variable type.
- **NoDefault**: A special Kestrun value that indicates no OpenAPI default value should be set for this response component variable.

**Reference Pattern in Functions:**

```powershell
function getArticle {
    [OpenApiPath(HttpVerb = 'get', Pattern = '/articles/{articleId}')]
  [OpenApiResponseRefAttribute(StatusCode = '200', ReferenceId = 'ArticleResponsesOK')]
  [OpenApiResponseRefAttribute(StatusCode = '404', ReferenceId = 'ArticleResponsesNotFound')]
    param([int]$articleId)
}
```

## Common Response Patterns

```powershell
# Success confirmation (ID, message, timestamp)
[OpenApiSchemaComponent(RequiredProperties = ('id', 'message', 'timestamp'))]
class SuccessResponse {
    [string]$id
    [string]$message
    [string]$timestamp
}

# Detailed error (code, message, field, details)
[OpenApiSchemaComponent(RequiredProperties = ('code', 'message'))]
class ErrorDetail {
    [string]$code
    [string]$message
    [string]$field
    [string]$details
}

# Data response (with metadata)
[OpenApiSchemaComponent(RequiredProperties = ('id', 'data'))]
class DataResponse {
    [string]$id
    [object]$data
    [string]$timestamp
}
```

## Key Concepts

- **Response Components**: Reusable OpenAPI responses declared by decorating variables with `[OpenApiResponseComponent]`.
- **Multiple Responses**: Define multiple response components (OK, Created, NotFound, etc.) as separate variables.
- **Inline Responses**: Use `Inline = $true` to include response definition inline instead of referencing a component.
- **Schema Definition**: The variable type (e.g. `[Article]`, `[ErrorResponse]`) drives the response schema.
- **Content Negotiation**: Specify multiple content types; `Write-KrResponse` auto-selects based on Accept header.
- **Reference Naming**: `ReferenceId` matches the variable name (e.g., `ArticleResponsesOK`).
- **Consistency**: Reusable response components ensure uniform error handling and success patterns across endpoints.
- **Documentation**: Response components automatically appear in OpenAPI `components.responses` section.

## Attribute Decoration Cheatsheet

| Purpose | Attribute | Usage |
|---------|-----------|-------|
| Response component variable | `[OpenApiResponseComponent(...)]` | Declares a reusable response component |
| Response reference | `[OpenApiResponseRefAttribute(StatusCode = '...', ReferenceId = '...')]` | References a response component variable in a function |
| Inline response | `Inline = $true` | Includes response inline instead of referencing |
| Response schema | `[Article]$ArticleResponsesOK = NoDefault` | Variable type defines schema for response |
| Content types | `ContentType = ('application/json', 'application/xml')` | MIME types supported by response |
| Response header | `[OpenApiResponseHeaderRef(...)]` | Associates a header component to the response |
| Response link | `[OpenApiResponseLinkRef(...)]` | Associates a link component to the response |
| Response example | `[OpenApiResponseExampleRef(...)]` | Associates an example component to the response |

## Troubleshooting

**Issue**: Response component reference not found.

- **Solution**: Check `ReferenceId` matches the response component variable name.

**Issue**: Inline responses not appearing correctly.

- **Solution**: Set `Inline = $true` in `[OpenApiResponseComponent]`
to embed response definition instead of referencing component.

## References

- [OpenApiResponseComponent][OpenApiResponseComponent]
- [OpenApiResponse][OpenApiResponse]
- [OpenApiResponseRefAttribute][OpenApiResponseRefAttribute]
- [OpenApiSchemaComponent][OpenApiSchemaComponent]
- [Write-KrResponse][Write-KrResponse]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [Parameter Components](./4.Parameter-Components.md)
Next: [Complete Components](./6.Complete-Components.md)

[OpenApiResponseComponent]: /pwsh/cmdlets/OpenApiResponseComponent
[OpenApiResponse]: /pwsh/cmdlets/OpenApiResponse
[OpenApiResponseRefAttribute]: /pwsh/cmdlets/OpenApiResponseRefAttribute
[OpenApiSchemaComponent]: /pwsh/cmdlets/OpenApiSchemaComponent
[Write-KrResponse]: /pwsh/cmdlets/Write-KrResponse
