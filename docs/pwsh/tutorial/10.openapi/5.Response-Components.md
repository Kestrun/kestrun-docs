---
title: Response Components
parent: OpenApi
nav_order: 5
---

# Response Components

Create reusable response components for consistent response structures across multiple endpoints.

## Full source

File: [`pwsh/tutorial/examples/10.5-OpenAPI-Component-Response.ps1`][10.5-OpenAPI-Component-Response.ps1]

```powershell
{% include examples/pwsh/10.5-OpenAPI-Component-Response.ps1 %}
```

## Step-by-step

1. **Logging**: Register console logger as default.
2. **Server**: Create server named 'OpenAPI Response Component' and add endpoint.
3. **OpenAPI info**: Add title and description.
4. **Schema components**: Define `ErrorResponse`, `Article`, and `SuccessResponse` schema classes.
5. **Response component**: Define `ArticleResponses` component with multiple response types:
   - `$OK` with inline response (inline = $true)
   - `$NotFound` with schema specified in attribute (Schema = [ErrorResponse])
   - `$objectResponse` with generic object (no type)
6. **Success response component**: Define `SuccessResponses` component wrapping SuccessResponse.
7. **Error response component**: Define `ErrorResponses` component wrapping ErrorResponse.
8. **GET endpoint**: Reference response component properties using `[OpenApiResponseRefAttribute]`.
9. **POST endpoint**: Create article with success/error response references.
10. **DELETE endpoint**: Delete article with success/error response references.
11. **Build and test**: Generate and validate OpenAPI document.

## Try it

```powershell
# Get article (success response)
curl -i http://127.0.0.1:5000/articles/1

# Get article with invalid ID (error response)
curl -i http://127.0.0.1:5000/articles/-1

# Create article (success response)
curl -X POST http://127.0.0.1:5000/articles `
  -H "Content-Type: application/json" `
  -d '{
    "title": "My Article",
    "content": "Article content here"
  }'

# Create with missing fields (error response)
curl -X POST http://127.0.0.1:5000/articles `
  -H "Content-Type: application/json" `
  -d '{"title": "Missing content"}'

# Delete article (success response)
curl -X DELETE http://127.0.0.1:5000/articles/1
```

PowerShell create example:

```powershell
$body = @{
    title   = 'My Article'
    content = 'Article content here'
} | ConvertTo-Json

Invoke-WebRequest -Uri http://127.0.0.1:5000/articles `
    -Method Post `
    -Headers @{ 'Content-Type' = 'application/json' } `
    -Body $body | Select-Object StatusCode, Content
```

## Response Component Attributes

**Basic Pattern:**

```powershell
[OpenApiResponseComponent(Description = 'Article responses')]
class ArticleResponses {
    [OpenApiResponseAttribute(Description = 'Article retrieved successfully', ContentType = ('application/json', 'application/xml'), Inline = $true)]
    [Article]$OK

    [OpenApiResponseAttribute(Description = 'Article not found', ContentType = ('application/json', 'application/xml'))]
    [ErrorResponse]$NotFound

    [OpenApiResponseAttribute()]
    $objectResponse
}
```

**Attribute Properties:**

- **`[OpenApiResponseComponent()]`**: Marks a class as a reusable response component.
- **`[OpenApiResponseAttribute(...)]`**: Decorates response properties with metadata.
  - **Description**: Human-readable response description.
  - **ContentType**: MIME types the response supports (e.g., `('application/json', 'application/xml')`).
  - **Inline**: If `$true`, includes response inline; otherwise references the component.
  - **Schema**: Specifies schema type directly in attribute (alternative to property type).

**Schema Definition Options:**

1. **Type on property**: `[ErrorResponse]$NotFound` — schema inferred from property type.
2. **Schema in attribute**: `Schema = [ErrorResponse]` — schema specified in `[OpenApiResponseAttribute]`.
3. **Generic object**: `$objectResponse` — no type specified; represents untyped response.

**Reference Pattern in Functions:**

```powershell
function getArticle {
    [OpenApiPath(HttpVerb = 'get', Pattern = '/articles/{articleId}')]
    [OpenApiResponseRefAttribute(StatusCode = '200', ReferenceId = 'ArticleResponsesOK')]
    [OpenApiResponseRefAttribute(StatusCode = '404', ReferenceId = 'ArticleResponsesNotFound')]
    param([int]$articleId)
}
```

**Note**: When `JoinClassName = '-'` is omitted, property names are used directly
(e.g., `ArticleResponsesOK`). When included, property names are joined with `-`
(e.g., `ArticleResponses-OK`).

## Common Response Patterns

```powershell
# Success confirmation (ID, message, timestamp)
[OpenApiSchemaComponent(Required = ('id', 'message', 'timestamp'))]
class SuccessResponse {
    [string]$id
    [string]$message
    [string]$timestamp
}

# Detailed error (code, message, field, details)
[OpenApiSchemaComponent(Required = ('code', 'message'))]
class ErrorDetail {
    [string]$code
    [string]$message
    [string]$field
    [string]$details
}

# Data response (with metadata)
[OpenApiSchemaComponent(Required = ('id', 'data'))]
class DataResponse {
    [string]$id
    [object]$data
    [string]$timestamp
}
```

## Key Concepts

- **Response Components**: Group related response types (success, error, specific) into reusable component classes.
- **Multiple Responses**: Define multiple response types in a single component (OK, Created, NotFound, etc.).
- **Inline Responses**: Use `Inline = $true` to include response definition inline instead of referencing a component.
- **Schema Definition Methods**:
  - Type on property: `[Article]$OK` — schema inferred from PowerShell class type.
  - Attribute-based: `Schema = [ErrorResponse]` — schema specified in attribute.
  - Generic: `$objectResponse` — untyped response for flexible structures.
- **Content Negotiation**: Specify multiple content types; `Write-KrResponse` auto-selects based on Accept header.
- **Reference Naming**: Without `JoinClassName = '-'`, use full property path in ReferenceId (e.g., `ArticleResponsesOK`).
- **Consistency**: Reusable response components ensure uniform error handling and success patterns across endpoints.
- **Documentation**: Response components automatically appear in OpenAPI `components.responses` section.

## Attribute Decoration Cheatsheet

| Purpose | Attribute | Usage |
|---------|-----------|-------|
| Response component class | `[OpenApiResponseComponent()]` | Marks class as reusable response definition |
| Response property | `[OpenApiResponseAttribute(...)]` | Decorates response property with metadata |
| Response reference | `[OpenApiResponseRefAttribute(StatusCode = '...', ReferenceId = '...')]` | References response component property in function |
| Inline response | `Inline = $true` | Includes response inline instead of referencing |
| Response schema | `[Article]$OK` or `Schema = [Article]` | Defines schema type for response |
| Generic response | `$objectResponse` (no type) | Represents untyped/flexible response |
| Content types | `ContentType = ('application/json', 'application/xml')` | MIME types supported by response |

## Troubleshooting

**Issue**: Response component reference not found.

- **Solution**: Check `ReferenceId` matches pattern `ClassName-PropertyName` (with JoinClassName) or `ClassNamePropertyName` (without).

**Issue**: Schema not defined for response.

- **Solution**: Either specify property type `[SchemaClass]$Property` or use `Schema = [SchemaClass]` in `[OpenApiResponseAttribute]`.

**Issue**: Inline responses not appearing correctly.

- **Solution**: Set `Inline = $true` in `[OpenApiResponseAttribute]` to embed response definition instead of referencing component.

## References

- [OpenApiResponseComponent][OpenApiResponseComponent]
- [OpenApiResponseAttribute][OpenApiResponseAttribute]
- [OpenApiResponseRefAttribute][OpenApiResponseRefAttribute]
- [OpenApiSchemaComponent][OpenApiSchemaComponent]
- [Write-KrResponse][Write-KrResponse]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [Parameter Components](./4.Parameter-Components.md)
Next: [Complete Components](./6.Complete-Components.md)

[OpenApiResponseComponent]: /pwsh/cmdlets/OpenApiResponseComponent
[OpenApiResponseAttribute]: /pwsh/cmdlets/OpenApiResponseAttribute
[OpenApiResponseRefAttribute]: /pwsh/cmdlets/OpenApiResponseRefAttribute
[OpenApiSchemaComponent]: /pwsh/cmdlets/OpenApiSchemaComponent
[Write-KrResponse]: /pwsh/cmdlets/Write-KrResponse
