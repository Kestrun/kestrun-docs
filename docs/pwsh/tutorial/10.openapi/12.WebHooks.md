---
title: WebHooks
parent: OpenApi
nav_order: 12
---

# WebHooks

Demonstrates how to define top-level WebHooks in the OpenAPI document.

Webhooks describe **outgoing notifications** your API may send to subscribers (for example: “order created”, “payment completed”).
This is different from **callbacks**, which are tied to a specific API operation.

## Full source

File: [`pwsh/tutorial/examples/10.12-OpenAPI-WebHook.ps1`][10.12-OpenAPI-WebHook.ps1]

```powershell
{% include examples/pwsh/10.12-OpenAPI-WebHook.ps1 %}
```

## Step-by-step

1. **Define webhook payload schemas** using `[OpenApiSchemaComponent()]`.
2. **Declare webhooks** using `[OpenApiWebhook()]` on functions. These appear under `webhooks` in the generated OpenAPI document.
3. **Optionally add “demo” endpoints** (regular paths) to simulate events and show example payloads.
4. **Generate & validate** the OpenAPI document using `Build-KrOpenApiDocument` and `Test-KrOpenApiDocument`.

## Try it

Run the script and open the generated documentation UI.

1. Start the example:

```powershell
pwsh -NoLogo -NoProfile -File .\docs\_includes\examples\pwsh\10.12-OpenAPI-WebHook.ps1
```

1. Open Swagger UI:

- `http://localhost:5000/swagger`

1. Fetch the OpenAPI document:

- `http://localhost:5000/openapi/v3.1/openapi.json`

1. Try the demo endpoints:

- `POST http://localhost:5000/api/orders/simulate`
- `POST http://localhost:5000/api/payments/simulate`
- `GET  http://localhost:5000/api/webhooks/info`

## Troubleshooting

**Issue**: `/api/*` routes return HTTP 500

- Verify the sample uses `Write-KrJsonResponse @{ ... } -StatusCode ...` (not `-Data`).

**Issue**: `webhooks` is missing from `openapi.json`

- Ensure the webhook functions are decorated with `[OpenApiWebhook()]`.
- Ensure `Add-KrOpenApiRoute` is present.
- Ensure `Build-KrOpenApiDocument` / `Test-KrOpenApiDocument` are executed without errors.

## References

- [OpenAPI Webhooks][OpenAPI Webhooks]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [Component Callbacks](./11.Component-Callbacks.md)
Next: [Examples](./13.Examples.md)

[10.12-OpenAPI-WebHook.ps1]: https://github.com/Kestrun/Kestrun/blob/main/docs/_includes/examples/pwsh/10.12-OpenAPI-WebHook.ps1
[OpenAPI Webhooks]: https://spec.openapis.org/oas/v3.1.0#webhooks
