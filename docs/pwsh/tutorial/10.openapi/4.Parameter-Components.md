---
title: Parameter Components
parent: OpenApi
nav_order: 4
---

# Parameter Components

Create reusable parameter components for query strings, path variables, headers, and cookies.

## Full source

File: [`pwsh/tutorial/examples/10.4-OpenAPI-Component-Parameter.ps1`][10.4-OpenAPI-Component-Parameter.ps1]

```powershell
{% include examples/pwsh/10.4-OpenAPI-Component-Parameter.ps1 %}
```

## Step-by-step

1. **Logging**: Register console logger as default.
2. **Server**: Create server named 'OpenAPI Parameter Component' and add endpoint.
3. **OpenAPI info**: Add title and description.
4. **Parameter component**: Define `PaginationParameters` component with page, limit, sortBy, category, minPrice, and maxPrice fields.
5. **Schema components**: Define `ProductItem` schema (id, name, category, price) and `ProductListResponse` schema (page, limit, total, items).
6. **Configuration**: Enable configuration and add Swagger/Redoc documentation routes.
7. **GET endpoint**: Define `listProducts` function with `[OpenApiPath]` attribute, reference parameters using `[OpenApiParameterRef]`.
8. **Response attributes**: Add `[OpenApiResponse]` attributes with `Schema = [ProductListResponse]` for 200 status.
9. **Filter and paginate**: Apply category and price filters, sort results, paginate with page/limit.
10. **Typed response**: Convert filtered results to `[ProductItem]` array, wrap in `[ProductListResponse]` object.
11. **Return response**: Use `Write-KrResponse` to automatically handle JSON/XML/YAML content negotiation.

## Try it

```powershell
# List products with pagination
curl -i "http://127.0.0.1:5000/products?page=1&limit=10"

# List with sorting
curl -i "http://127.0.0.1:5000/products?page=1&limit=10&sortBy=price"

# List with category filter
curl -i "http://127.0.0.1:5000/products?category=electronics&limit=20"

# List with price range filter
curl -i "http://127.0.0.1:5000/products?minPrice=100&maxPrice=1000"

# Combine filters and pagination
curl -i "http://127.0.0.1:5000/products?category=office&minPrice=40&maxPrice=100&page=1&limit=5&sortBy=price"
```

PowerShell with parameter hashtable:

```powershell
$params = @{
    page    = 1
    limit   = 10
    sortBy  = 'price'
    category = 'electronics'
}

$uri = "http://127.0.0.1:5000/products?" + ($params.GetEnumerator() | ForEach-Object { "$($_.Key)=$($_.Value)" } -join '&')

Invoke-WebRequest -Uri $uri | Select-Object StatusCode, Content
```

## Parameter Component Attributes

```powershell
[OpenApiParameterComponent()]
class PaginationParameters {
    [OpenApiParameter(In = [OaParameterLocation]::Query, Description = 'Page number')]
    [OpenApiPropertyAttribute(Minimum = 1, Example = 1)]
    [int]$page

    [OpenApiParameter(In = [OaParameterLocation]::Query, Description = 'Items per page')]
    [OpenApiPropertyAttribute(Minimum = 1, Maximum = 100, Example = 20)]
    [int]$limit

    [OpenApiParameter(In = [OaParameterLocation]::Query, Description = 'Sort field (name, date, price)')]
    [OpenApiPropertyAttribute(Example = 'date')]
    [ValidateSet('name', 'date', 'price')]
    [string]$sortBy
}
```

**Attribute Pattern:**

- **`[OpenApiParameterComponent()]`**: Marks a class as a reusable parameter component.
- **`[OpenApiParameter(In = ..., Description = ...)]`**: Defines parameter location (Query, Path, Header, Cookie) and description.
- **`[OpenApiPropertyAttribute(...)]`**: Decorates properties with schema constraints (Minimum, Maximum, Format, Example).
- **`[ValidateSet(...)]`**: Restricts values to enumerated list; appears in OpenAPI as `enum`.

**Usage in Functions:**

```powershell
function listProducts {
    param(
        [OpenApiParameterRef(ReferenceId = 'page')]
        [int]$page = 1,

        [OpenApiParameterRef(ReferenceId = 'limit')]
        [int]$limit = 20
    )
}
```

## Parameter Locations

Parameters can be in different locations:

- **Query**: `?page=1&limit=10` (most common for filtering/pagination).
- **Path**: `/products/{productId}` (dynamic route segments).
- **Header**: Custom HTTP headers.
- **Cookie**: Cookie values.

## Key Concepts

- **Parameter Components**: Define reusable query, path, header, or cookie parameters once, reference with `[OpenApiParameterRef(ReferenceId = 'paramName')]`.
- **Attribute Layering**: Combine `[OpenApiParameter]` (location, description) with `[OpenApiPropertyAttribute]` (schema constraints).
- **Schema Components**: Use `[OpenApiSchemaComponent()]` classes to define response structures (ProductItem, ProductListResponse).
- **Typed Responses**: Convert hashtables to typed PowerShell class instances for accurate OpenAPI schema documentation.
- **Content Negotiation**: `Write-KrResponse` automatically handles JSON, XML, YAML, and form-urlencoded based on Accept header.
- **Pagination**: Use `page` and `limit` parameters for result limiting and offset.
- **Filtering**: Combine filter parameters to narrow results (category, price range, date range).
- **Sorting**: Allow clients to specify sort order via `sortBy` parameter.
- **Validation**: Use constraints (Minimum, Maximum, Format) to document and validate parameter values.

## Attribute Decoration Cheatsheet

| Purpose | Attribute | Usage |
|---------|-----------|-------|
| Parameter component class | `[OpenApiParameterComponent()]` | Marks class as reusable parameter definition |
| Parameter location | `[OpenApiParameter(In = [OaParameterLocation]::Query)]` | Defines where parameter appears (Query/Path/Header/Cookie) |
| Parameter reference | `[OpenApiParameterRef(ReferenceId = 'name')]` | References parameter component in function params |
| Schema component class | `[OpenApiSchemaComponent()]` | Marks class as reusable schema definition |
| Property schema | `[OpenApiPropertyAttribute(...)]` | Defines property constraints (Minimum, Maximum, Format, Example) |
| Route definition | `[OpenApiPath(HttpVerb = 'get', Pattern = '/path')]` | Maps function to HTTP endpoint |
| Response schema | `[OpenApiResponse(StatusCode = '200', Schema = [ClassName])]` | Documents response status and schema |

## Troubleshooting

**Issue**: Parameter reference not found in OpenAPI spec.

- **Solution**: Ensure property name in `[OpenApiParameterRef(ReferenceId = 'propertyName')]` matches the property name in the parameter component class.

**Issue**: Query parameters not being parsed correctly.

- **Solution**: Verify `In = [OaParameterLocation]::Query` is set on each parameter property in the component class.

**Issue**: Validation constraints not appearing in OpenAPI.

- **Solution**: Add validation using `[OpenApiPropertyAttribute(Minimum = ..., Maximum = ...)]` on parameter properties.

## References

- [OpenApiParameterComponent][OpenApiParameterComponent]
- [OpenApiParameter][OpenApiParameter]
- [OpenApiParameterRef][OpenApiParameterRef]
- [OpenApiPropertyAttribute][OpenApiPropertyAttribute]
- [OpenApiSchemaComponent][OpenApiSchemaComponent]
- [OpenApiPath][OpenApiPath]
- [OpenApiResponse][OpenApiResponse]
- [Write-KrResponse][Write-KrResponse]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [RequestBody Components](./3.RequestBody-Components.md)
Next: [Response Components](./5.Response-Components.md)

[OpenApiParameterComponent]: /pwsh/cmdlets/OpenApiParameterComponent
[OpenApiParameter]: /pwsh/cmdlets/OpenApiParameter
[OpenApiParameterRef]: /pwsh/cmdlets/OpenApiParameterRef
[OpenApiPropertyAttribute]: /pwsh/cmdlets/OpenApiPropertyAttribute
[OpenApiSchemaComponent]: /pwsh/cmdlets/OpenApiSchemaComponent
[OpenApiPath]: /pwsh/cmdlets/OpenApiPath
[OpenApiResponse]: /pwsh/cmdlets/OpenApiResponse
[Write-KrResponse]: /pwsh/cmdlets/Write-KrResponse
