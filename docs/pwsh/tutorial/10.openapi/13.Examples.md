---
title: Examples
parent: OpenApi
nav_order: 13
---

# Examples

Demonstrates OpenAPI example components plus inline examples applied to requests, responses, and parameters.

## Full source

File: [`pwsh/tutorial/examples/10.13-OpenAPI-Examples.ps1`][10.13-OpenAPI-Examples.ps1]

```powershell
{% include examples/pwsh/10.13-OpenAPI-Examples.ps1 %}
```

## Step-by-step

1. **Logging**: Register a console logger and set level to Debug.
2. **Server**: Create the `Examples API` server and bind to 127.0.0.1:5000.
3. **Metadata**: Set OpenAPI info (title, version, description); register Swagger and Redoc viewers.
4. **Schemas**: Define request/response models for ticket purchase and museum hours with `[OpenApiSchemaComponent]`.
5. **Component examples**: Create `components/examples` via `New-KrOpenApiExample | Add-KrOpenApiComponent`.
6. **Inline examples**: Store date snippets with `Add-KrOpenApiInline` for reuse without `$ref`.
7. **Routes**: Annotate `buyTicket`, `getMuseumHours`, and `searchTickets` with `*ExampleRef` attributes for body, response, and parameter examples.
8. **Docs**: Add OpenAPI route, build the document, and start the server.

## Try it

```powershell
# Purchase a ticket (uses component request/response examples in the doc)
curl -i -X POST http://127.0.0.1:5000/tickets `
  -H "Content-Type: application/json" `
  -d '{"ticketType":"general","ticketDate":"2023-09-07","email":"todd@example.com"}'

# View museum hours (response example from components/examples)
curl -i http://127.0.0.1:5000/museum-hours

# Search tickets (query parameter examples from inline store copied inline)
curl -i "http://127.0.0.1:5000/tickets/search?ticketDate=2023-09-07"
```

## Key Points

- **Component examples** live under `components/examples` and are referenced by `*ExampleRef` attributes using `ReferenceId`.
- **Inline examples** use `Add-KrOpenApiInline`; when referenced, they are embedded directly instead of `$ref`.
- **Mixed usage**: Combine both approaches on the same routeâ€”component examples for bodies/responses, inline examples for simple scalar parameters.

## Where examples appear in openapi.json

### Component examples (with `$ref`)

- Stored once under `components.examples.<ExampleName>`
- Referenced from operations using `$ref`

Common locations:

- Request body examples: `paths['/tickets'].post.requestBody.content['application/json'].examples['general_entry'].$ref`
- Response examples: `paths['/tickets'].post.responses['201'].content['application/json'].examples['general_entry'].$ref`

### Inline examples (no `$ref`)

Inline examples are **not** emitted under `components/examples`. When you reference them with `OpenApiParameterExampleRef`,
Kestrun copies the values into the parameter definition directly:

- `paths['/tickets/search'].get.parameters[*].examples['today'].value`

This is useful for small scalars (dates, page sizes, enums) where you want the value visible at the usage site.

## Troubleshooting

**Issue**: Examples do not appear in Swagger UI.

- **Solution**: Verify `Build-KrOpenApiDocument` runs after example registration and that `Add-KrApiDocumentationRoute` is enabled.

**Issue**: Parameter examples still show `$ref`.

- **Solution**: Ensure the example was added with `Add-KrOpenApiInline`; inline examples are copied, while component examples remain `$ref`.

## References

- [New-KrOpenApiExample][New-KrOpenApiExample]
- [Add-KrOpenApiComponent][Add-KrOpenApiComponent]
- [Add-KrOpenApiInline][Add-KrOpenApiInline]
- [OpenApiRequestBodyExampleRef][OpenApiRequestBodyExampleRef]
- [OpenApiResponseExampleRef][OpenApiResponseExampleRef]
- [OpenApiParameterExampleRef][OpenApiParameterExampleRef]
- [Add-KrApiDocumentationRoute][Add-KrApiDocumentationRoute]
- [Add-KrOpenApiRoute][Add-KrOpenApiRoute]
- [Build-KrOpenApiDocument][Build-KrOpenApiDocument]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [WebHooks](./12.WebHooks.md)
Next: [Swagger Petstore](./14.Petstore-API.md)

[10.13-OpenAPI-Examples.ps1]: https://github.com/Kestrun/Kestrun/blob/main/docs/_includes/examples/pwsh/10.13-OpenAPI-Examples.ps1
[New-KrOpenApiExample]: /pwsh/cmdlets/New-KrOpenApiExample
[Add-KrOpenApiComponent]: /pwsh/cmdlets/Add-KrOpenApiComponent
[Add-KrOpenApiInline]: /pwsh/cmdlets/Add-KrOpenApiInline
[OpenApiRequestBodyExampleRef]: /pwsh/cmdlets/OpenApiRequestBodyExampleRef
[OpenApiResponseExampleRef]: /pwsh/cmdlets/OpenApiResponseExampleRef
[OpenApiParameterExampleRef]: /pwsh/cmdlets/OpenApiParameterExampleRef
[Add-KrApiDocumentationRoute]: /pwsh/cmdlets/Add-KrApiDocumentationRoute
[Add-KrOpenApiRoute]: /pwsh/cmdlets/Add-KrOpenApiRoute
[Build-KrOpenApiDocument]: /pwsh/cmdlets/Build-KrOpenApiDocument
