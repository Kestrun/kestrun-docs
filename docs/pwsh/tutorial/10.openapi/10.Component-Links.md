---
title: Component Links
parent: OpenApi
nav_order: 10
---

# Component Links

Demonstrates how to define reusable link components to describe relationships between operations.

Link components are stored under `components/links` and can be referenced from operation responses.
This makes it easy to express common “next-step” relationships such as *create → get*, *get → update*, and *update → delete*.

## Full source

File: [`pwsh/tutorial/examples/10.10-OpenAPI-Component-Link.ps1`][10.10-OpenAPI-Component-Link.ps1]

```powershell
{% include examples/pwsh/10.10-OpenAPI-Component-Link.ps1 %}
```

## Step-by-step

1. **Define link components** with `New-KrOpenApiLink` and store them with `Add-KrOpenApiComponent`.

   - Example: map `userId` from `$response.body#/id`.
   - Example: map `requestBody` from `$response.body#/user` for update operations.

2. **Apply links to responses** using `OpenApiResponseLinkRef`.

   - Example: attach `GetUserLink`, `UpdateUserLink`, and `DeleteUserLink` to the `201` response of `createUser`.

3. **Build the OpenAPI document** with `Add-KrOpenApiRoute` + `Build-KrOpenApiDocument`.

## What links look like

### Define a link component

```powershell
New-KrOpenApiLink -OperationId 'getUser' -Description 'Get the created/returned user.' `
   -Parameters @{ userId = '$response.body#/id' } |
   Add-KrOpenApiComponent -Name 'GetUserLink'
```

#### Link extensions (`x-*`)

You can attach vendor extensions to link components using `New-KrOpenApiLink -Extensions`.

> **Note:** OpenAPI vendor extension keys must start with `x-`. Keys that do not start with `x-` are ignored (Kestrun logs a warning).

Example:

```powershell
New-KrOpenApiLink -OperationId 'getUser' -Description 'Get the created/returned user.' `
   -Parameters @{ userId = '$response.body#/id' } `
   -Extensions ([ordered]@{
      'x-kestrun-demo' = [ordered]@{
         relation = 'get'
         targetOperation = 'getUser'
         parameterSource = '$response.body#/id'
      }
   }) |
   Add-KrOpenApiComponent -Name 'GetUserLink'
```

### Reference it from a response

```powershell
function createUser {
   [OpenApiPath(HttpVerb = 'post', Pattern = '/users', Tags = 'Users')]
   [OpenApiResponse(StatusCode = '201', Description = 'Created')]
   [OpenApiResponseLinkRef(StatusCode = '201', Key = 'get', ReferenceId = 'GetUserLink')]
   param()
}
```

### Where to find it in openapi.json

- `components.links.GetUserLink` contains the actual link object (operationId + mappings)
- `paths['/users'].post.responses['201'].links.get.$ref` points to `#/components/links/GetUserLink`

## Try it

Run the sample and open:

- `http://localhost:5000/docs/swagger`
- `http://localhost:5000/docs/redoc`
- `http://localhost:5000/openapi/v3.1/openapi.json`

Then inspect:

- `components.links.GetUserLink`, `components.links.UpdateUserLink`, `components.links.DeleteUserLink`
- `components.links.GetUserLink.x-kestrun-demo`
- `paths['/users'].post.responses['201'].links`
- `paths['/users/{userId}'].get.responses['200'].links`

## Troubleshooting

**Issue**: Links don’t show up in the OpenAPI output.

- Ensure you called `Add-KrOpenApiRoute` and then `Build-KrOpenApiDocument`.
- Ensure the `ReferenceId` passed to `OpenApiResponseLinkRef` matches the component name used with `Add-KrOpenApiComponent`.
- Ensure link mappings use the correct runtime expression strings (for example `$response.body#/id`).

## References

- [OpenAPI Link Object][OpenAPI Link Object]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [Component Headers](./9.Component-Headers)
Next: [Component Callbacks](./11.Component-Callbacks)

[10.10-OpenAPI-Component-Link.ps1]: https://github.com/Kestrun/Kestrun/blob/main/docs/_includes/examples/pwsh/10.10-OpenAPI-Component-Link.ps1
[OpenAPI Link Object]: https://spec.openapis.org/oas/v3.1.0#link-object
