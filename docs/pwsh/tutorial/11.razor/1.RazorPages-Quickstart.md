---
title: Razor Pages Quickstart
parent: Razor
nav_order: 1
---

# Razor Pages Quickstart

Serve Razor Pages where each `.cshtml` can have an optional sibling `.cshtml.ps1` script that builds a per-request model.

## Full source

File: [`pwsh/tutorial/examples/11.1-RazorPages.ps1`][11.1-RazorPages.ps1]

```powershell
{% include examples/pwsh/11.1-RazorPages.ps1 %}
```

## Step-by-step

1. Root: Call `Initialize-KrRoot` so the sample can use relative paths reliably.
2. Logging: Create a console logger and set it as default.
3. Server: Create a server named `RazorPages`.
4. Listener: Bind to the configured IP address and port.
5. Razor runtime: Enable PowerShell-backed Razor Pages with `Add-KrPowerShellRazorPagesRuntime`.
6. App state: Define `$AppInfo`, `$FeatureFlags`, and `$Motd` to be visible to all pages.
7. Pipeline: Finalize the server configuration with `Enable-KrConfiguration`.
8. Start: Start the server with `Start-KrServer`.

## Try it

```powershell
# Home page
curl -i http://127.0.0.1:5000/

# A couple of sample pages (served from the pages folder)
curl -i http://127.0.0.1:5000/About
curl -i http://127.0.0.1:5000/Status
```

PowerShell equivalents:

```powershell
Invoke-WebRequest http://127.0.0.1:5000/ | Select-Object StatusCode, Headers
Invoke-WebRequest http://127.0.0.1:5000/About | Select-Object StatusCode
Invoke-WebRequest http://127.0.0.1:5000/Status | Select-Object StatusCode
```

## How the page model works

- For a request like `/About`, Razor renders `About.cshtml`.
- If `About.cshtml.ps1` exists, Kestrun runs it first.
- The page script sets `$Model` (commonly a `PSCustomObject`), and Razor can read it via `@model Kestrun.PowerShellPageModel` and `Model.Data`.

## Troubleshooting

| Symptom | Cause | Fix |
|---------|-------|-----|
| 404 for all pages | Razor runtime not enabled | Ensure `Add-KrPowerShellRazorPagesRuntime` is called before `Enable-KrConfiguration` and `Start-KrServer` |
| 404 for a specific page | File name or path mismatch | Confirm the `.cshtml` file exists under the configured `-RootPath` and casing matches on Linux |
| Page renders but model is empty | No sibling script or `$Model` not set | Add `Page.cshtml.ps1` and assign `$Model` (for example a `PSCustomObject`) |
| Relative paths fail | Root not initialized | Call `Initialize-KrRoot -Path $PSScriptRoot` at the top of the script |

## References

- [Initialize-KrRoot][Initialize-KrRoot]
- [New-KrLogger][New-KrLogger]
- [Set-KrLoggerLevel][Set-KrLoggerLevel]
- [Add-KrSinkConsole][Add-KrSinkConsole]
- [Register-KrLogger][Register-KrLogger]
- [New-KrServer][New-KrServer]
- [Add-KrEndpoint][Add-KrEndpoint]
- [Add-KrPowerShellRazorPagesRuntime][Add-KrPowerShellRazorPagesRuntime]
- [Get-KrVersion][Get-KrVersion]
- [Write-KrLog][Write-KrLog]
- [Enable-KrConfiguration][Enable-KrConfiguration]
- [Start-KrServer][Start-KrServer]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [Razor](./index)
Next: [Razor Pages with Antiforgery][Next]

[11.1-RazorPages.ps1]: /pwsh/tutorial/examples/11.1-RazorPages.ps1
[Initialize-KrRoot]: /pwsh/cmdlets/Initialize-KrRoot
[New-KrLogger]: /pwsh/cmdlets/New-KrLogger
[Set-KrLoggerLevel]: /pwsh/cmdlets/Set-KrLoggerLevel
[Add-KrSinkConsole]: /pwsh/cmdlets/Add-KrSinkConsole
[Register-KrLogger]: /pwsh/cmdlets/Register-KrLogger
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrEndpoint]: /pwsh/cmdlets/Add-KrEndpoint
[Add-KrPowerShellRazorPagesRuntime]: /pwsh/cmdlets/Add-KrPowerShellRazorPagesRuntime
[Get-KrVersion]: /pwsh/cmdlets/Get-KrVersion
[Write-KrLog]: /pwsh/cmdlets/Write-KrLog
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
[Next]: ./2.RazorPages-Antiforgery
