---
title: Full Demo
parent: Authentication
nav_order: 9
---

# Full Authentication Demo

Integrated example combining Basic, API Key, JWT, Cookies, claims & policies.

## Full source

File: [`Authentication.ps1`][Authentication-Full]

> The full script is large; earlier chapters break it into focused pieces. Review for orchestration patterns.

## Step-by-step (high level)

1. Configure logging, server options & limits.
2. Add listeners (HTTP + HTTPS if cert available).
3. Register all auth schemes (Basic, API Key, JWT, Cookies, Windows).\*
4. Build claim policy set (create/read/write/delete/admin).
5. Enable configuration.
6. Map grouped secure routes & token issuance endpoints.
7. Start server.

\*Windows auth requires platform support.

## Try it

See inline examples at top of the script for a comprehensive sequence generating Basic header, API key, issuing JWT token,
renewing, and performing cookie login.

## Cmdlet references

(Aggregate of previous chapter references.)

## Troubleshooting

| Symptom                      | Cause                            | Fix                                          |
| ---------------------------- | -------------------------------- | -------------------------------------------- |
| One scheme works others fail | Misordered registration / enable | Register all before `Enable-KrConfiguration` |
| Token renewal fails          | Invalid bearer on renew route    | Use original or unexpired token              |
| Cookie route 401             | Session not persisted            | Reuse same WebRequestSession                 |

---

### Next

Continue with server internals:

- Start with [Server Limits](../13.server-configuration/1.Server-Limits)
- Then [Server Options](../13.server-configuration/2.Server-Options)
- Or skip ahead to [Start / Stop Lifecycle](../14.lifecycle/1.Start-Stop)

[Authentication-Full]: https://github.com/Kestrun/Kestrun/blob/main/examples/PowerShell/Authentication/Authentication.ps1
