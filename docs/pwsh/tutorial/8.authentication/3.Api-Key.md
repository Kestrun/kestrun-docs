---
title: API Key
parent: Authentication
nav_order: 3
---

# API Key Authentication

Validate requests using an API key header (fixed value, script, or inline C#/VB code).

## Full source

File: [`pwsh/tutorial/examples/8.3-Api-Key.ps1`][8.3-Api-Key.ps1]

```powershell
{% include examples/pwsh/8.3-Api-Key.ps1 %}
```

## Step-by-step

1. Create server & listener.
2. Register three key schemes: simple fixed, script validation, C# code.
3. Enable configuration.
4. Map routes for each scheme.
5. Start server.

## Try it

```powershell
$h = @{ 'X-Api-Key' = 'my-secret-api-key' }
Invoke-WebRequest http://127.0.0.1:5000/secure/key/simple/hello -Headers $h | Select -Expand Content
Invoke-WebRequest http://127.0.0.1:5000/secure/key/ps/hello -Headers $h | Select -Expand Content
Invoke-WebRequest http://127.0.0.1:5000/secure/key/cs/hello -Headers $h | Select -Expand Content
```

## Cmdlet references

- [Add-KrApiKeyAuthentication][Add-KrApiKeyAuthentication]
- [Add-KrMapRoute][Add-KrMapRoute]
- [Add-KrRouteGroup][Add-KrRouteGroup]
- [New-KrServer][New-KrServer]
- [Add-KrListener][Add-KrListener]
- [Add-KrPowerShellRuntime][Add-KrPowerShellRuntime]
- [Enable-KrConfiguration][Enable-KrConfiguration]
- [Start-KrServer][Start-KrServer]

## Troubleshooting

| Symptom               | Cause                       | Fix                               |
| --------------------- | --------------------------- | --------------------------------- |
| 401 Unauthorized      | Missing / wrong key         | Provide correct `X-Api-Key` value |
| Works for simple only | Script/code scheme mismatch | Ensure header name & scheme used  |

---

### Next

Continue to [JWT Tokens](./4.Jwt).

[8.3-Api-Key.ps1]: /pwsh/tutorial/examples/8.3-Api-Key.ps1
[Add-KrApiKeyAuthentication]: /pwsh/cmdlets/Add-KrApiKeyAuthentication
[Add-KrMapRoute]: /pwsh/cmdlets/Add-KrMapRoute
[Add-KrRouteGroup]: /pwsh/cmdlets/Add-KrRouteGroup
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrListener]: /pwsh/cmdlets/Add-KrListener
[Add-KrPowerShellRuntime]: /pwsh/cmdlets/Add-KrPowerShellRuntime
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
