---
title: SSE
parent: Middleware
nav_order: 9
layout: default
---

# SSE

Stream real-time server events to browsers using Server-Sent Events (SSE).

## Full source

File: [`pwsh/tutorial/examples/15.9-Sse.ps1`][15.9-Sse.ps1]

```powershell
{% include examples/pwsh/15.9-Sse.ps1 %}
```

## Step-by-step

1. Logging: Register a console logger as default.
2. Server: Create a server and listener (IP + port).
3. Configuration: Enable configuration so routes/middleware are materialized.
4. Home page: Serve an HTML page with an `EventSource` client.
5. Input: Read `count` and `intervalMs` from query parameters.
6. SSE response: Start the SSE response with `Start-KrSseResponse`.
7. Events: Emit `connected`, `tick`, and `complete` SSE events using `Write-KrSseEvent`.
8. Run: Start the server and connect from a browser or curl.

## Try it

Start the server:

```powershell
pwsh .\docs\_includes\examples\pwsh\15.9-Sse.ps1
```

Stream a short SSE response (closes after `count` events):

```powershell
curl -N "http://127.0.0.1:5000/sse?count=3&intervalMs=100"
```

Open the demo UI:

```powershell
Start-Process http://127.0.0.1:5000/
```

## Troubleshooting

| Symptom | Cause | Fix |
|--------|-------|-----|
| Browser reconnects repeatedly | Stream closes (expected) | This sample intentionally ends the stream after `count` events; close the `EventSource` on `onerror`. |
| No events arrive | Proxy buffering | Ensure you use `Start-KrSseResponse` and avoid middleware that buffers responses. |
| `curl` hangs | Stream is long-running | Use small `count` values when testing from CLI. |

## References

- [Initialize-KrRoot][Initialize-KrRoot]
- [New-KrLogger][New-KrLogger]
- [Set-KrLoggerLevel][Set-KrLoggerLevel]
- [Add-KrSinkConsole][Add-KrSinkConsole]
- [Register-KrLogger][Register-KrLogger]
- [New-KrServer][New-KrServer]
- [Add-KrEndpoint][Add-KrEndpoint]
- [Enable-KrConfiguration][Enable-KrConfiguration]
- [Add-KrMapRoute][Add-KrMapRoute]
- [Get-KrRequestQuery][Get-KrRequestQuery]
- [Start-KrSseResponse][Start-KrSseResponse]
- [Write-KrSseEvent][Write-KrSseEvent]
- [Write-KrHtmlResponse][Write-KrHtmlResponse]
- [Write-KrLog][Write-KrLog]
- [Start-KrServer][Start-KrServer]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [CORS](./8.Cors)
Next: [SSE Broadcast](./10.SseBroadcast)

[15.9-Sse.ps1]: /pwsh/tutorial/examples/15.9-Sse.ps1
[Initialize-KrRoot]: /pwsh/cmdlets/Initialize-KrRoot
[New-KrLogger]: /pwsh/cmdlets/New-KrLogger
[Set-KrLoggerLevel]: /pwsh/cmdlets/Set-KrLoggerLevel
[Add-KrSinkConsole]: /pwsh/cmdlets/Add-KrSinkConsole
[Register-KrLogger]: /pwsh/cmdlets/Register-KrLogger
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrEndpoint]: /pwsh/cmdlets/Add-KrEndpoint
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Add-KrMapRoute]: /pwsh/cmdlets/Add-KrMapRoute
[Get-KrRequestQuery]: /pwsh/cmdlets/Get-KrRequestQuery
[Start-KrSseResponse]: /pwsh/cmdlets/Start-KrSseResponse
[Write-KrSseEvent]: /pwsh/cmdlets/Write-KrSseEvent
[Write-KrHtmlResponse]: /pwsh/cmdlets/Write-KrHtmlResponse
[Write-KrLog]: /pwsh/cmdlets/Write-KrLog
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
