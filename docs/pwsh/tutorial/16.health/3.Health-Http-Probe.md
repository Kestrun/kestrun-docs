---
title: HTTP Probe
parent: Health
nav_order: 3
---

# HTTP Probe

Shows using the builtâ€‘in HTTP probe to call an internal route and fold its success/failure into the health aggregate.

## Full source

File: [`pwsh/tutorial/examples/16.3-Health-Http-Probe.ps1`][16.3-Health-Http-Probe.ps1]

```powershell
{% include examples/pwsh/16.3-Health-Http-Probe.ps1 %}
```

## Step-by-step

1. Register an HTTP probe with `-Kind Http` and a loopback `-Url`.
2. Configure optional handling: `-TreatRedirectAsSuccess`, `-TreatNotFoundAsSuccess`.
3. Tag the probe as needed for filtering.
4. Start the server and query `/healthz`.

## Try it

```powershell
Invoke-RestMethod http://127.0.0.1:5002/healthz | ConvertTo-Json -Depth 4
```

Break the `/status` route (rename or stop server) and observe the probe become `Unhealthy`.

## Troubleshooting

| Symptom | Cause | Fix |
|---------|-------|-----|
| Probe timeout | Remote route slow | Increase endpoint timeout or optimize route |
| 404 recorded as failure | Endpoint removed/renamed | Adjust probe URL or treat not found as success (only if expected) |

[16.3-Health-Http-Probe.ps1]: /pwsh/tutorial/examples/16.3-Health-Http-Probe.ps1

## References

- [Add-KrHttpProbe][Add-KrHttpProbe]
- [Add-KrHealthEndpoint][Add-KrHealthEndpoint]

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [Script Probe](./2.Health-Script-Probe)
Next: [Process Probe](./4.Health-Process-Probe)

[Add-KrHttpProbe]: /pwsh/cmdlets/Add-KrHttpProbe
[Add-KrHealthEndpoint]: /pwsh/cmdlets/Add-KrHealthEndpoint
