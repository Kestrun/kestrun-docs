---
title: HTTP Probe
parent: Health
nav_order: 3
---

# HTTP Probe

Shows using the builtâ€‘in HTTP probe to call an internal route and fold its success/failure into the health aggregate.

## Full source

File: [`pwsh/tutorial/examples/16.3-Health-Http-Probe.ps1`][16.3-Health-Http-Probe.ps1]

```powershell
{% include examples/pwsh/16.3-Health-Http-Probe.ps1 %}
```

## Key Points

- `-Kind Http` selects the HTTP probe factory.
- `-Url` can be loopback (recommended) or an external service.
- `-TreatRedirectAsSuccess`/`-TreatNotFoundAsSuccess` allow relaxing strict status handling.
- Combine with defaults: endpoint `-DefaultTags` + probe `-Tags`.

## Try It

```powershell
Invoke-RestMethod http://127.0.0.1:5002/healthz | ConvertTo-Json -Depth 4
```

Break the `/status` route (rename or stop server) and observe the probe become `Unhealthy`.

## Troubleshooting

| Symptom | Cause | Fix |
|---------|-------|-----|
| Probe timeout | Remote route slow | Increase endpoint timeout or optimize route |
| 404 recorded as failure | Endpoint removed/renamed | Adjust probe URL or treat not found as success (only if expected) |

[16.3-Health-Http-Probe.ps1]: /pwsh/tutorial/examples/16.3-Health-Http-Probe.ps1
