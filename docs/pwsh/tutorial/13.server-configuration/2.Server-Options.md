---
title: Server Options
parent: Server Configuration
nav_order: 2
---

# Server Options

Configure runtime behaviors (headers, compression, runspaces) with `Set-KrServerOptions`.

> Prerequisites: [Endpoints](../7.endpoints/index) basics; review [Logging](../5.logging/index) to observe effects.

## Full source

File: [`pwsh/tutorial/examples/13.2-Server-Options.ps1`][13.2-Server-Options.ps1]

```powershell
{% include examples/pwsh/13.2-Server-Options.ps1 %}
```

## Step-by-step

1. Create server + listener (loopback:5000).
2. Add runtime.
3. Apply options (`-DenyServerHeader`, runspace pool sizing, etc.).
4. Enable configuration (commits listeners + runtime + options).
5. Map `/info` route returning status/time.
6. Start server.

## Common flags

| Option                            | Purpose                                       |
| --------------------------------- | --------------------------------------------- |
| -DenyServerHeader                 | Remove Server header                          |
| -AllowSynchronousIO               | Permit legacy sync IO (avoid unless required) |
| -DisableResponseHeaderCompression | Debug proxies / diagnostics                   |
| -MaxRunspaces / -MinRunspaces     | Script concurrency tuning                     |

## Try it

Show removal of the `Server` response header when using `-DenyServerHeader`.

```powershell
# With -DenyServerHeader (no Server header expected)
Invoke-WebRequest -Uri http://127.0.0.1:5000/info | Format-List StatusCode,Headers,Content

# For comparison restart WITHOUT -DenyServerHeader then:
Invoke-WebRequest -Uri http://127.0.0.1:5000/info | Select-Object -ExpandProperty RawContent
```

Expected (with `-DenyServerHeader`): headers DO NOT include `Server: Kestrel`.

Expected (without): response contains a `Server: Kestrel` header.

## References

- [Set-KrServerOptions][Set-KrServerOptions]
- [New-KrServer][New-KrServer]
- [Add-KrEndpoint][Add-KrEndpoint]
- [Enable-KrConfiguration][Enable-KrConfiguration]
- [Add-KrMapRoute][Add-KrMapRoute]
- [Write-KrJsonResponse][Write-KrJsonResponse]
- [Start-KrServer][Start-KrServer]

## Troubleshooting

| Symptom                 | Cause                      | Fix                           |
| ----------------------- | -------------------------- | ----------------------------- |
| Still see Server header | Option applied after start | Apply before `Start-KrServer` |
| High CPU                | Too many runspaces         | Reduce `-MaxRunspaces`        |
| Slow throughput         | Too few runspaces          | Increase `-MaxRunspaces`      |

See also: [Server Limits](./1.Server-Limits) Â· [Logging](../5.logging/index)

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [Server Limits](./1.Server-Limits.md)
Next: [Demos](../14.demos/index)

[13.2-Server-Options.ps1]: /pwsh/tutorial/examples/13.2-Server-Options.ps1
[Set-KrServerOptions]: /pwsh/cmdlets/Set-KrServerOptions
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrEndpoint]: /pwsh/cmdlets/Add-KrEndpoint
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Add-KrMapRoute]: /pwsh/cmdlets/Add-KrMapRoute
[Write-KrJsonResponse]: /pwsh/cmdlets/Write-KrJsonResponse
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
