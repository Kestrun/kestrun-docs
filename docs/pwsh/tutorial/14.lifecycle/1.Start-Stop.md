---
title: Start/Stop Patterns
parent: Lifecycle
nav_order: 1
---

# Start/Stop Patterns

Control server lifecycle: blocking vs non‑blocking, programmatic shutdown.

## Full source

File: [`pwsh/tutorial/examples/15.1-Start-Stop.ps1`][15.1-Start-Stop.ps1]

```powershell
{% include examples/pwsh/15.1-Start-Stop.ps1 %}
```

## Step-by-step

1. Create server with `-PassThru` to retain object.
2. Add listener/runtime & enable config.
3. Map `/health` route.
4. Start non‑blocking: `Start-KrServer -NoWait`.
5. Perform work (press Enter) then call `Stop-KrServer`.
6. Remove server to clean resources.

## Patterns

| Pattern | How |
|---------|-----|
| Blocking | `Start-KrServer` (Ctrl+C) |
| Non-blocking | `Start-KrServer -NoWait` + later `Stop-KrServer` |
| Programmatic | Maintain server object (`-PassThru`) |

## Try it

```powershell
# Start non-blocking
pwsh .\docs\_includes\examples\pwsh\15.1-Start-Stop.ps1
# In another terminal, hit health
Invoke-RestMethod http://127.0.0.1:5000/health
```

## References

- [Start-KrServer][Start-KrServer]
- [Stop-KrServer][Stop-KrServer]
- [Remove-KrServer][Remove-KrServer]
- [New-KrServer][New-KrServer]
- [Add-KrEndpoint][Add-KrEndpoint]
- [Enable-KrConfiguration][Enable-KrConfiguration]
- [Add-KrMapRoute][Add-KrMapRoute]

## Troubleshooting

| Symptom | Cause | Fix |
|---------|-------|-----|
| Cannot stop | Missing reference | Capture server with `-PassThru` |
| Hanging exit | Pending requests | Allow active requests to finish or force stop |

See also: [Endpoints](../7.endpoints/index) · [Logging](../5.logging/index)

---

### Previous / Next

{: .fs-4 .fw-500}

Previous: [Server Options](../13.server-configuration/2.Server-Options.md)
Next: [Demos](../15.demos/index)

[15.1-Start-Stop.ps1]: /pwsh/tutorial/examples/15.1-Start-Stop.ps1
[Start-KrServer]: /pwsh/cmdlets/Start-KrServer
[Stop-KrServer]: /pwsh/cmdlets/Stop-KrServer
[Remove-KrServer]: /pwsh/cmdlets/Remove-KrServer
[New-KrServer]: /pwsh/cmdlets/New-KrServer
[Add-KrEndpoint]: /pwsh/cmdlets/Add-KrEndpoint
[Enable-KrConfiguration]: /pwsh/cmdlets/Enable-KrConfiguration
[Add-KrMapRoute]: /pwsh/cmdlets/Add-KrMapRoute
