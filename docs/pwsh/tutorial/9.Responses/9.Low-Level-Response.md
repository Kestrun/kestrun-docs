---
title: Low-Level Response Stream
parent: Responses
nav_order: 9
---

# Low-Level Response Stream

`Write-KrResponse` exposes the raw body stream (currently typed for `System.IO.Stream`). Use only when higher-level helpers do not fit.

## Full source

File: [`pwsh/tutorial/examples/9.9-Low-Level-Response.ps1`][9.9-Low-Level-Response.ps1]

```powershell
{% include examples/pwsh/9.9-Low-Level-Response.ps1 %}
```

## Step-by-step

1. Server & listener on 5099.
2. `/raw`: creates MemoryStream from UTF-8 bytes.
3. Calls `Write-KrResponse` to push raw stream with status 200.
4. Start server.

## Try it

```powershell
curl -i http://127.0.0.1:5099/raw
```

PowerShell equivalents:

```powershell
Invoke-WebRequest -Uri http://127.0.0.1:5099/raw     | Select -Expand RawContent
Invoke-WebRequest -Uri http://127.0.0.1:5099/manual  | Select -Expand RawContent
Invoke-WebRequest -Uri http://127.0.0.1:5099/pipeline | Select -Expand RawContent

# Streaming with .Content (auto-decoded UTF-8)
Invoke-WebRequest -Uri http://127.0.0.1:5099/raw | Select -Expand Content
```

## Example

```powershell
Add-KrMapRoute -Path '/raw' -Method GET -ScriptBlock {
    $bytes = [System.Text.Encoding]::UTF8.GetBytes('raw-stream')
    $ms = New-Object System.IO.MemoryStream(,$bytes)
    Write-KrResponse -InputObject $ms -StatusCode 200
}
```

### When to use

| Situation | Rationale |
|-----------|-----------|
| Custom serialization pipeline | Encoder already writes to a stream |
| Chunked / progressive output | Manually control flush timing |
| Experimental formats | No dedicated helper yet |

### References

- [Write-KrResponse](/pwsh/cmdlets/Write-KrResponse)

---

### Previous / End

Previous: [Caching & Revalidation](./8.Caching)
You have reached the end of the Responses section. Return to the [Responses Overview](./index) or explore the next major topic.

[9.9-Low-Level-Response.ps1]: /pwsh/tutorial/examples/9.9-Low-Level-Response.ps1
