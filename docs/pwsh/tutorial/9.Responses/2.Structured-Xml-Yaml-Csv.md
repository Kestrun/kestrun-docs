---
title: Structured (XML / YAML / CSV)
parent: Responses
nav_order: 2
---

# Structured (XML / YAML / CSV)

Return alternative serializations for interoperability, configuration and exports.

## Full source

File: [`pwsh/tutorial/examples/9.2-Structured-Xml-Yaml-Csv.ps1`][9.2-Structured-Xml-Yaml-Csv.ps1]

```powershell
{% include examples/pwsh/9.2-Structured-Xml-Yaml-Csv.ps1 %}
```

## Step-by-step

1. Server & listener on 5092.
2. `/xml`: serialize PSCustomObject to XML.
3. `/yaml`: serialize PSCustomObject to YAML (human-readable config style).
4. `/csv`: build collection, output CSV text.
5. Start server.

## Try it

```powershell
curl http://127.0.0.1:5092/xml
curl http://127.0.0.1:5092/yaml
curl http://127.0.0.1:5092/csv
```

PowerShell equivalents:

```powershell
Invoke-WebRequest -Uri http://127.0.0.1:5092/xml | Select -ExpandProperty Content
Invoke-WebRequest -Uri http://127.0.0.1:5092/yaml | Select -ExpandProperty Content
Invoke-WebRequest -Uri http://127.0.0.1:5092/csv  | Select -ExpandProperty Content
```

## XML

```powershell
Add-KrMapRoute -Path '/xml' -Method GET -ScriptBlock {
    [pscustomobject]@{ Id = 1; Name = 'Alpha' } | Write-KrXmlResponse -ContentType 'application/xml'
}
```

## YAML

```powershell
Add-KrMapRoute -Path '/yaml' -Method GET -ScriptBlock {
    [pscustomobject]@{ env = 'dev'; enabled = $true } | Write-KrYamlResponse -ContentType 'application/x-yaml'
}
```

## CSV

Provide a collection; PowerShell converts objects to CSV text first if needed.

```powershell
Add-KrMapRoute -Path '/csv' -Method GET -ScriptBlock {
    $data = 1..3 | ForEach-Object { [pscustomobject]@{ Id=$_; Square = $_*$_ } }
    $data | Write-KrCsvResponse -StatusCode 200 -ContentType 'text/csv'
}
```

### Tips

- Prefer JSON for public APIs; use XML/YAML when clients require it.
- For very large tabular exports consider streaming (see Binary & Stream chapter).

### References

- [Write-KrXmlResponse](/pwsh/cmdlets/Write-KrXmlResponse)
- [Write-KrYamlResponse](/pwsh/cmdlets/Write-KrYamlResponse)
- [Write-KrCsvResponse](/pwsh/cmdlets/Write-KrCsvResponse)

---

### Previous / Next

Previous: [Text & JSON](./1.Basic-Text-Json)
Next: [Binary & Stream](./3.Binary-Stream)

[9.2-Structured-Xml-Yaml-Csv.ps1]: /pwsh/tutorial/examples/9.2-Structured-Xml-Yaml-Csv.ps1
