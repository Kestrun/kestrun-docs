---
title: Structured (XML / YAML / CSV)
parent: Responses
nav_order: 2
---

# Structured (XML / YAML / CSV)

Return alternative serializations for interoperability, configuration and exports.

## Full source

File: [`pwsh/tutorial/examples/9.2-Structured-Xml-Yaml-Csv.ps1`][9.2-Structured-Xml-Yaml-Csv.ps1]

```powershell
{% include examples/pwsh/9.2-Structured-Xml-Yaml-Csv.ps1 %}
```

## Step-by-step

1. Logging: Register console logger as default.
2. Server: Create server named 'Responses 9.2'.
3. Listener: Listen on 127.0.0.1:5000.
4. Runtime: Add PowerShell runtime.
5. `/xml`: serialize object with nested property to XML.
6. `/yaml`: serialize object with array property to YAML.
7. `/csv`: build collection, output CSV text.
8. Enable configuration and start server.

## Try it

```powershell
curl http://127.0.0.1:5000/xml
curl http://127.0.0.1:5000/yaml
curl http://127.0.0.1:5000/csv
```

PowerShell equivalents:

```powershell
Invoke-RestMethod -Uri http://127.0.0.1:5000/xml
Invoke-RestMethod -Uri http://127.0.0.1:5000/yaml
Invoke-WebRequest -Uri http://127.0.0.1:5000/csv  | Select -ExpandProperty Content
```

## Example routes

```powershell
# Logging
New-KrLogger | Add-KrSinkConsole | Register-KrLogger -Name 'console' -SetAsDefault

# Server
New-KrServer -Name 'Responses 9.2'

# Listener
Add-KrListener -IPAddress '127.0.0.1' -Port 5000

# Runtime
Add-KrPowerShellRuntime

# Enable configuration
Enable-KrConfiguration

# XML route
Add-KrMapRoute -Pattern '/xml' -Verbs GET -ScriptBlock {
    @{ Id = 1; Name = 'Alpha'; Nested = @{ X = 10; Y = 20 } } | Write-KrXmlResponse -ContentType 'application/xml'
}

# YAML route
Add-KrMapRoute -Pattern '/yaml' -Verbs GET -ScriptBlock {
    @{ env = 'dev'; enabled = $true; tags = @('one','two') } | Write-KrYamlResponse -ContentType 'application/x-yaml'
}

# CSV route
Add-KrMapRoute -Pattern '/csv' -Verbs GET -ScriptBlock {
    $data = 1..5 | ForEach-Object { @{ Id = $_; Square = ($_ * $_) } }
    $data | Write-KrCsvResponse -ContentType 'text/csv'
}

# Start the server
Start-KrServer
```

### Tips

- Prefer JSON for public APIs; use XML/YAML when clients require it.
- For very large tabular exports consider streaming (see Binary & Stream chapter).

### References

- [Write-KrXmlResponse](/pwsh/cmdlets/Write-KrXmlResponse)
- [Write-KrYamlResponse](/pwsh/cmdlets/Write-KrYamlResponse)
- [Write-KrCsvResponse](/pwsh/cmdlets/Write-KrCsvResponse)

---

### Previous / Next

Previous: [Text & JSON](./1.Basic-Text-Json)
Next: [Binary & Stream](./3.Binary-Stream)

[9.2-Structured-Xml-Yaml-Csv.ps1]: /pwsh/tutorial/examples/9.2-Structured-Xml-Yaml-Csv.ps1
