---
title: Special Formats (BSON / CBOR)
parent: Responses
nav_order: 5
---

# Special Formats (BSON / CBOR)

Binary object encodings for compact storage or specialized clients.

## Full source

File: [`pwsh/tutorial/examples/9.5-Bson-Cbor.ps1`][9.5-Bson-Cbor.ps1]

```powershell
{% include examples/pwsh/9.5-Bson-Cbor.ps1 %}
```

## Step-by-step

1. Logging: Register console logger as default.
2. Server: Create server named 'Responses 9.5'.
3. Listener: Listen on 127.0.0.1:5000.
4. Runtime: Add PowerShell runtime.
5. `/bson`: serialize object to BSON.
6. `/cbor`: serialize object to CBOR.
7. Enable configuration and start server.

## Try it

```powershell
curl http://127.0.0.1:5000/bson --output payload.bson
curl http://127.0.0.1:5000/cbor --output payload.cbor
```

PowerShell equivalents:

```powershell
# BSON
Invoke-WebRequest -Uri http://127.0.0.1:5000/bson -OutFile out.bson
# CBOR
Invoke-WebRequest -Uri http://127.0.0.1:5000/cbor -OutFile out.cbor
# Plain fallback
Invoke-WebRequest -Uri http://127.0.0.1:5000/plain | Select -Expand Content
```

## Example routes

```powershell
# Logging
New-KrLogger | Add-KrSinkConsole | Register-KrLogger -Name 'console' -SetAsDefault

# Server
New-KrServer -Name 'Responses 9.5'

# Listener
Add-KrListener -IPAddress '127.0.0.1' -Port 5000

# Runtime
Add-KrPowerShellRuntime

# Enable configuration
Enable-KrConfiguration

# BSON route
Add-KrMapRoute -Pattern '/bson' -Verbs GET -ScriptBlock {
    @{ kind = 'bson'; ts = (Get-Date).ToUniversalTime(); values = 1..3 } | Write-KrBsonResponse -ContentType 'application/bson'
}

# CBOR route
Add-KrMapRoute -Pattern '/cbor' -Verbs GET -ScriptBlock {
    @{ kind = 'cbor'; ts = (Get-Date).ToUniversalTime(); values = 4..6 } | Write-KrCborResponse -ContentType 'application/cbor'
}

# Start the server
Start-KrServer
```

### When to use

### References

### Previous / Next

Previous: [HTML Templates & Files](./4.Html-Templates-Files)
Next: [Redirects](./6.Redirects)

[9.5-Bson-Cbor.ps1]: /pwsh/tutorial/examples/9.5-Bson-Cbor.ps1
