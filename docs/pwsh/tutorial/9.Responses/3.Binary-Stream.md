---
title: Binary & Stream
parent: Responses
nav_order: 3
---

# Binary & Stream Responses

Use these when returning non-text payloads, large files, or custom generated data.

## Full source

File: [`pwsh/tutorial/examples/9.3-Binary-Stream.ps1`][9.3-Binary-Stream.ps1]

```powershell
{% include examples/pwsh/9.3-Binary-Stream.ps1 %}
```

## Step-by-step

1. Server & listener on 5093.
2. `/logo`: resolves file, reads all bytes, writes binary response.
3. `/stream`: opens text file stream, writes via streaming helper.
4. Error handling: returns error response if file missing.
5. Start server.

## Try it

```powershell
curl http://127.0.0.1:5093/logo --output logo.bin
curl http://127.0.0.1:5093/stream
```

PowerShell equivalents:

```powershell
Invoke-WebRequest -Uri http://127.0.0.1:5093/logo -OutFile logo.bin
Invoke-WebRequest -Uri http://127.0.0.1:5093/stream | Select -ExpandProperty Content
```

## Binary (byte[] cached in memory)

```powershell
Add-KrMapRoute -Path '/logo' -Method GET -ScriptBlock {
    $bytes = [System.IO.File]::ReadAllBytes((Resolve-KrPath -Path 'Assets/wwwroot/files/sample.bin' -KestrunRoot -Test))
    Write-KrBinaryResponse -InputObject $bytes -ContentType 'application/octet-stream'
}
```

## Stream (no full buffering)

```powershell
Add-KrMapRoute -Path '/stream' -Method GET -ScriptBlock {
    $fs = [System.IO.File]::OpenRead((Resolve-KrPath -Path 'Assets/wwwroot/files/sample.txt' -KestrunRoot -Test))
    Write-KrStreamResponse -InputObject $fs -ContentType 'text/plain'
}
```

### When to choose which

| Scenario | Helper |
|----------|--------|
| Small binary (< 1â€“2 MB) | `Write-KrBinaryResponse` |
| Large file on disk | `Write-KrStreamResponse` |
| Dynamically generated large data | Create a memory or pipe stream and use `Write-KrStreamResponse` |

### References

- [Write-KrBinaryResponse](/pwsh/cmdlets/Write-KrBinaryResponse)
- [Write-KrStreamResponse](/pwsh/cmdlets/Write-KrStreamResponse)

---

### Previous / Next

Previous: [Structured (XML / YAML / CSV)](./2.Structured-Xml-Yaml-Csv)
Next: [HTML Templates & Files](./4.Html-Templates-Files)

[9.3-Binary-Stream.ps1]: /pwsh/tutorial/examples/9.3-Binary-Stream.ps1
