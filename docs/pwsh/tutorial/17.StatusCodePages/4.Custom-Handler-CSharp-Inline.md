---
title: Custom Handler (C# Inline)
parent: Status Code Pages
nav_order: 4
---

# Custom Handler (C# Inline)

Handle status codes with an inline C# snippet that composes a JSON payload and writes the response.

## Full source

File: [`pwsh/tutorial/examples/17.4-StatusCodePages-CustomCSharp.ps1`][17.4-StatusCodePages-CustomCSharp.ps1]

```powershell
{% include examples/pwsh/17.4-StatusCodePages-CustomCSharp.ps1 %}
```

## Step-by-step

1. Logging: Register a console logger.
2. Code: Provide C# via `-Code` and `-Language CSharp`.
3. Middleware: Enable StatusCodePages with the inline C# code.
4. Routes: Map `/hello` and demo routes for 404/500/403/401.
5. Start: Apply configuration and start the server.

## Try it

```powershell
curl -i http://127.0.0.1:5000/hello
curl -i http://127.0.0.1:5000/notfound
curl -i http://127.0.0.1:5000/error
curl -i http://127.0.0.1:5000/forbidden
curl -i http://127.0.0.1:5000/unauthorized
```

PowerShell equivalents:

```powershell
Invoke-WebRequest -Uri http://127.0.0.1:5000/hello | Select-Object StatusCode, Content
Invoke-WebRequest -Uri http://127.0.0.1:5000/notfound    -SkipHttpErrorCheck | Select-Object StatusCode, Content | Format-List
Invoke-WebRequest -Uri http://127.0.0.1:5000/error       -SkipHttpErrorCheck | Select-Object StatusCode, Content | Format-List
Invoke-WebRequest -Uri http://127.0.0.1:5000/forbidden   -SkipHttpErrorCheck | Select-Object StatusCode, Content | Format-List
Invoke-WebRequest -Uri http://127.0.0.1:5000/unauthorized -SkipHttpErrorCheck | Select-Object StatusCode, Content | Format-List
```

## Troubleshooting

| Symptom | Likely cause | Fix |
|--------|---------------|-----|
| Compile error | C# code snippet syntax | Validate code uses `Context.Response` helpers and compiles |
| No JSON output | Forgot to write response | Call `Context.Response.WriteJsonResponse(...)` |
| Handler not triggered | Wrong parameter usage | Ensure `-Code` and `-Language CSharp` are set on `Enable-KrStatusCodePage` |

## References

- [Enable-KrStatusCodePage][Enable-KrStatusCodePage]

---

### Previous / Next

Previous: [Custom Handler (PowerShell)](./3.Custom-Handler-PowerShell.md)
Next: [Content Format](./5.Content-Format.md)

[17.4-StatusCodePages-CustomCSharp.ps1]: /pwsh/tutorial/examples/17.4-StatusCodePages-CustomCSharp.ps1
[Enable-KrStatusCodePage]: /pwsh/cmdlets/Enable-KrStatusCodePage
