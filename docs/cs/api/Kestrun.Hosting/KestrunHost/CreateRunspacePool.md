---
layout: default
title: "KestrunHost.CreateRunspacePool method"
parent: "Kestrun.Hosting"
grand_parent: "C# API"
---
# KestrunHost.CreateRunspacePool method

Creates and returns a new [`KestrunRunspacePoolManager`](../../Kestrun.Scripting/KestrunRunspacePoolManager) instance with the specified maximum number of runspaces.

```csharp
public KestrunRunspacePoolManager CreateRunspacePool(int? maxRunspaces = 0, 
    Dictionary<string, object>? userVariables = null, 
    Dictionary<string, string>? userFunctions = null)
```

| parameter | description |
| --- | --- |
| maxRunspaces | The maximum number of runspaces to create. If not specified or zero, defaults to twice the processor count. |
| userVariables | A dictionary of user-defined variables to inject into the runspace pool. |
| userFunctions | A dictionary of user-defined functions to inject into the runspace pool. |

## Return Value

A configured [`KestrunRunspacePoolManager`](../../Kestrun.Scripting/KestrunRunspacePoolManager) instance.

## See Also

* class [KestrunRunspacePoolManager](../../Kestrun.Scripting/KestrunRunspacePoolManager)
* class [KestrunHost](../KestrunHost)
* namespace [Kestrun.Hosting](../../Kestrun)

<!-- DO NOT EDIT: generated by xmldo for Kestrun.dll -->
