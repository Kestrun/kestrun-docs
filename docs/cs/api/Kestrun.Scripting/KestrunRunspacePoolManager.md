---
layout: default
title: "KestrunRunspacePoolManager class"
parent: "Kestrun.Scripting"
grand_parent: "C# API"
---
# KestrunRunspacePoolManager class

Manages a pool of PowerShell runspaces for efficient reuse and resource control.

```csharp
public sealed class KestrunRunspacePoolManager : IDisposable
```

## Public Members

| name | description |
| --- | --- |
| [KestrunRunspacePoolManager](KestrunRunspacePoolManager/KestrunRunspacePoolManager)(…) | Initializes a new instance of the [`KestrunRunspacePoolManager`](./KestrunRunspacePoolManager) class with the specified minimum and maximum runspaces, initial session state, and thread options. |
| [Host](KestrunRunspacePoolManager/Host) { get; } | KestrunHost is needed for logging, config, etc. |
| [MaxRunspaces](KestrunRunspacePoolManager/MaxRunspaces) { get; } | Gets the maximum number of runspaces allowed in the pool. |
| [MinRunspaces](KestrunRunspacePoolManager/MinRunspaces) { get; } | Gets the minimum number of runspaces maintained in the pool. |
| [ThreadOptions](KestrunRunspacePoolManager/ThreadOptions) { get; set; } | Thread‑affinity strategy for *future* runspaces. Default is ReuseThread. |
| [Acquire](KestrunRunspacePoolManager/Acquire)() | Borrow a runspace (creates one if under the cap). |
| [AcquireAsync](KestrunRunspacePoolManager/AcquireAsync)(…) | Asynchronously acquires a runspace from the pool, creating a new one if under the cap, or waits until one becomes available. |
| [Dispose](KestrunRunspacePoolManager/Dispose)() | Disposes the runspace pool manager and all pooled runspaces. |
| [Release](KestrunRunspacePoolManager/Release)(…) | Returns a runspace to the pool for reuse, or disposes it if the pool has been disposed. |

## See Also

* namespace [Kestrun.Scripting](../Kestrun)

<!-- DO NOT EDIT: generated by xmldo for Kestrun.dll -->
